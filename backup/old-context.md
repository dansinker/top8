This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2024-11-20T22:53:07.061Z

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Repository files, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

- Line numbers have been added to the beginning of each line.
</notes>

<additional_info>

For more information about Repomix, visit: https://github.com/yamadashy/repomix
</additional_info>

</file_summary>

<repository_structure>
css/
  styles.css
images/
  logo.svg
  top8.svg
js/
  alpine-integration.js
  auth.js
  config.js
  main.js
  pds.js
  posts.js
  profile.js
  storage.js
  theme.js
  themePDS.js
  top8.js
.gitattributes
.gitignore
index.html
README.md
</repository_structure>

<repository_files>
This section contains the contents of the repository's files.

<file path="css/styles.css">
  1: body {
  2:     font-family: sans-serif;
  3:     background-attachment: fixed;
  4:     background-repeat: repeat;
  5: }
  6: 
  7: body.default {
  8:     background-color: lightblue;
  9:     color: black;
 10: }
 11: 
 12: #logo,
 13: #footer {
 14:     background-color: var(--logobox-color);
 15:     margin-bottom: 30px;
 16:     margin-top: 30px;
 17:     margin-left: auto;
 18:     margin-right: auto;
 19:     width: 1000px;
 20:     border: 1px solid white;
 21: }
 22: 
 23: #logo h1 {
 24:     color: white;
 25:     text-align: center;
 26: }
 27: 
 28: #logo img {
 29:     width: 250px;
 30:     padding: 15px;
 31:     margin-left: 10px;
 32:     fill: var(--logo-color);
 33: }
 34: 
 35: #wrapper {
 36: }
 37: 
 38: #wholething {
 39:     width: 1000px;
 40:     margin-left: auto;
 41:     margin-right: auto;
 42: }
 43: 
 44: #leftcolumn {
 45:     float: left;
 46:     width: 320px;
 47:     padding: 10px;
 48:     padding-left: 0;
 49:     margin-right: 20px;
 50:     overflow: hidden;
 51: }
 52: 
 53: #rightcolumn {
 54:     display: block;
 55:     overflow: hidden;
 56: }
 57: 
 58: #profilebox {
 59:     overflow: hidden;
 60:     margin-bottom: 20px;
 61:     margin-top: -10px;
 62: }
 63: 
 64: #profilebox img {
 65:     width: 300px;
 66:     border: 1px solid blue;
 67: }
 68: 
 69: .box h1 {
 70:     background-color: var(--h1-color);
 71:     border-bottom: 1px solid white;
 72:     color: white;
 73:     padding: 10px;
 74:     font-size: 1em;
 75: }
 76: 
 77: #editbutton {
 78:     float: right;
 79: }
 80: 
 81: #profilebox h2 {
 82:     font-size: 1em;
 83: }
 84: 
 85: #profilebox h2 a {
 86:     color: black;
 87: }
 88: 
 89: iframe {
 90:     margin-bottom: 20px;
 91: }
 92: 
 93: #top8box,
 94: #postbox,
 95: .box {
 96:     border: 1px solid white;
 97:     background-color: var(--background-color);
 98:     color: var(--font-color);
 99:     padding: 10px;
100:     overflow: hidden;
101:     max-width: 700px;
102:     margin-bottom: 20px;
103: }
104: 
105: #top8box h1,
106: #postbox h1,
107: .box h1 {
108:     background-color: var(--header-color);
109:     border-bottom: 1px solid white;
110:     color: var(--h1-color);
111:     margin-left: -11px;
112:     margin-right: -10px;
113:     margin-top: -10px;
114:     font-size: 1em;
115:     padding: 10px;
116:     overflow: hidden;
117: }
118: 
119: .friend {
120:     float: left;
121:     padding: 10px;
122: }
123: 
124: .friend img {
125:     width: 120px;
126:     border: 1px solid blue;
127: }
128: 
129: .friend h2 {
130:     font-size: 1em;
131: }
132: 
133: div.post {
134:     padding-bottom: 20px;
135:     border-bottom: 1px solid white;
136: }
137: 
138: p.post img {
139:     width: 200px;
140:     margin-bottom: 10px;
141:     margin-left: -10px;
142: }
143: 
144: p.post:last-child {
145:     border-bottom: none;
146: }
147: 
148: /* Color Themes */
149: .pink {
150:     --background-color: rgb(232, 177, 227, 0.6);
151:     --picker-color: #da03d0;
152:     --header-color: #da03d0;
153:     --h1-color: #2b0425;
154:     --font-color: #000000;
155:     --logobox-color: #740764;
156:     --logo-color: white;
157:     --background-image: url(/images/390g.gif);
158: }
159: .dark-blue {
160:     --background-color: #172a3a80;
161:     --picker-color: #172a3a;
162:     --h1-color: #000000;
163:     --header-color: white;
164:     --font-color: #eee;
165:     --logobox-color: #0d1589;
166:     --logo-color: white;
167:     --background-image: url(/images/4f.gif);
168: }
169: .almond {
170:     --background-color: #d9c5b290;
171:     --picker-color: #d9c5b2;
172:     --header-color: #c57d00;
173:     --h1-color: white;
174:     --font-color: #000000;
175:     --logobox-color: #764d05;
176:     --logo-color: #c57d00;
177:     --background-image: url(/images/169b.jpg);
178: }
179: .vampire {
180:     --background-color: #00000080;
181:     --picker-color: #000000;
182:     --header-color: #6e0505;
183:     --h1-color: white;
184:     --font-color: #f5efef;
185:     --logobox-color: #6e0505;
186:     --logo-color: white;
187:     --background-image: url(/images/206c.gif);
188: }
189: .toxic {
190:     --background-color: #e5ff00b6;
191:     --picker-color: #06b72c;
192:     --header-color: #0b6533;
193:     --h1-color: rgb(246, 255, 0);
194:     --font-color: #000000;
195:     --logobox-color: #073e1a;
196:     --logo-color: rgb(246, 255, 0);
197:     --background-image: url(/images/215b.gif);
198: }
199: 
200: .shoes {
201:     --background-color: #ff00f7b6;
202:     --picker-color: #b923ff;
203:     --h1-color: #00fbffb1;
204:     --header-color: #000000;
205:     --font-color: #afef9b;
206:     --logobox-color: #ff00f7b6;
207:     --logo-color: #afef9b;
208:     --background-image: url(/images/176z.gif);
209: }
210: 
211: .angels {
212:     --background-color: #98e1f3b6;
213:     --picker-color: #98e1f3;
214:     --header-color: #acf3ccc8;
215:     --h1-color: #426889;
216:     --font-color: #3a0d30;
217:     --logobox-color: #acf3ccc4;
218:     --logo-color: #426889;
219:     --background-image: url(/images/76a.jpg);
220: }
221: 
222: .night {
223:     --background-color: #3a0d30;
224:     --h1-color: white;
225:     --header-color: #bb4100;
226:     --picker-color: #bb4100;
227:     --font-color: #afafaf;
228:     --logobox-color: #bb4100;
229:     --logo-color: white;
230:     --background-image: url(/images/1128n.gif);
231: }
232: 
233: .pastel {
234:     --background-color: #ffd4f6;
235:     --h1-color: #e2acd9;
236:     --header-color: #65335c;
237:     --picker-color: #e2acd9;
238:     --font-color: #afafaf;
239:     --logobox-color: #65335c;
240:     --logo-color: #be87b5;
241:     --background-image: url(/images/639d.jpg);
242: }
243: 
244: /* Color Choice */
245: .color-choice {
246:     height: 30px;
247:     width: 30px;
248:     background-color: var(--picker-color);
249:     border-radius: 50%;
250:     border: 1px solid black;
251:     display: inline-block;
252:     margin-right: 2px;
253:     cursor: pointer;
254: }
255: .color-choice:hover {
256:     border: 1px solid white;
257: }
258: .color-theme-container {
259: }
260: /* Color Theme Application*/
261: body {
262:     color: var(--font-color);
263:     background-image: var(--background-image);
264: }
265: 
266: #footer p {
267:     color: #e5ff00b6;
268:     text-align: center;
269: }
270: 
271: @media (max-width: 768px) {
272:     #wholething {
273:         width: auto;
274:     }
275: 
276:     #logo,
277:     #footer {
278:         width: auto;
279:     }
280:     #leftcolumn {
281:         float: none;
282:         width: auto;
283:         margin-right: 0;
284:     }
285: }
286: 
287: /* login */
288: 
289: /* top 8 */
290: 
291: /* Add these styles to your existing CSS file */
292: 
293: .dialog-overlay {
294:     backdrop-filter: blur(2px);
295: }
296: 
297: .dialog-content {
298:     box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
299: }
300: 
301: .search-box {
302:     margin: 1em 0;
303: }
304: 
305: .search-box input {
306:     width: 100%;
307:     padding: 8px;
308:     border: 1px solid var(--header-color);
309:     border-radius: 4px;
310: }
311: 
312: .search-results {
313:     margin-top: 1em;
314:     max-height: 400px;
315:     overflow-y: auto;
316: }
317: 
318: .friend-item {
319:     display: flex;
320:     align-items: center;
321:     padding: 10px;
322:     border: 1px solid transparent;
323:     margin-bottom: 8px;
324:     cursor: pointer;
325:     transition: all 0.2s ease;
326: }
327: 
328: .friend-item:hover {
329:     background-color: rgba(0, 0, 0, 0.05);
330: }
331: 
332: .friend-item.selected {
333:     border-color: var(--header-color);
334:     background-color: rgba(var(--header-color), 0.1);
335: }
336: 
337: .friend-item .avatar {
338:     width: 40px;
339:     height: 40px;
340:     border-radius: 50%;
341:     margin-right: 12px;
342: }
343: 
344: .friend-item .friend-info {
345:     display: flex;
346:     flex-direction: column;
347: }
348: 
349: .friend-item .handle {
350:     font-size: 0.9em;
351:     color: var(--font-color);
352:     opacity: 0.7;
353: }
354: 
355: .dialog-buttons {
356:     margin-top: 1em;
357:     display: flex;
358:     justify-content: flex-end;
359:     gap: 8px;
360: }
361: 
362: .error-message {
363:     color: #ff0000;
364:     margin: 8px 0;
365:     padding: 8px;
366:     background-color: rgba(255, 0, 0, 0.1);
367:     border-radius: 4px;
368: }
369: 
370: .friends-grid {
371:     display: grid;
372:     grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
373:     gap: 16px;
374:     margin-top: 1em;
375: }
376: 
377: .friends-grid .friend {
378:     text-align: center;
379: }
380: 
381: .friends-grid .friend img {
382:     width: 100px;
383:     height: 100px;
384:     border-radius: 50%;
385:     margin-bottom: 8px;
386: }
387: 
388: .loading-indicator {
389:     margin-top: 8px;
390:     font-size: 0.9em;
391:     color: var(--font-color);
392: }
393: 
394: .progress-note {
395:     font-size: 0.8em;
396:     opacity: 0.8;
397:     margin-top: 4px;
398: }
</file>

<file path="images/logo.svg">
 1: <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
 2:         viewBox="0 0 360.1 63.2" style="enable-background:new 0 0 360.1 63.2;" xml:space="preserve">
 3:             <path class="st0" d="M85.2,35.7c-1.1-2.3-2.6-4-4.5-5.3c-0.6-0.5-1.1-0.8-1.4-1.1s-0.4-0.6-0.4-0.9c0-0.4,0.1-0.8,0.3-1.1
 4:        c0.2-0.4,0.6-0.8,1.2-1.2c1.3-1.2,2.2-2.6,2.9-4.2c0.6-1.6,1-3.3,1-4.9c0-2.9-0.8-5.5-2.3-7.7s-3.8-3.9-6.9-5.1s-6.9-1.8-11.6-1.8
 5:        S54.9,3,51.9,4.2c-2.5,1-4.4,2.3-5.9,3.9c-0.9-0.7-1.9-1.3-3.2-1.8c-2.3-0.9-5.1-1.4-8.6-1.4s-6.3,0.5-8.6,1.4s-3.9,2.2-5.1,3.8
 6:        l-1.2-0.6c-1.3-0.5-3-0.8-5.1-0.8c-2,0-3.7,0.3-5.1,0.8c-1.3,0.5-2.3,1.3-3,2.2c-0.7,1-1,2.1-1,3.4c0,0.7,0.1,1.4,0.4,2.1
 7:        s0.7,1.3,1.3,1.8c0.3,0.2,0.4,0.4,0.5,0.5s0.1,0.3,0.1,0.5c0,0.1-0.1,0.3-0.2,0.4s-0.3,0.3-0.6,0.5c-0.8,0.5-1.4,1.3-1.9,2.3
 8:        S4,25.2,4,26.3c0,1.5,0.4,2.8,1.1,4c0.8,1.1,1.9,2,3.4,2.7s3.4,1,5.6,1c1,0,1.9-0.1,2.8-0.2c0,0.4-0.1,0.8-0.1,1.1
 9:        c0,2.5,0.6,4.8,1.9,6.7s3.2,3.4,5.8,4.5s5.7,1.6,9.5,1.7c2.4,0,4.5-0.3,6.4-0.7c0.4,1.8,1.1,3.4,2.1,4.9c1.8,2.6,4.4,4.6,7.8,6.1
10:        c3.5,1.5,7.8,2.2,12.8,2.3c5.1-0.1,9.4-0.8,12.9-2.3c3.4-1.5,6.1-3.5,7.8-6.1c1.8-2.6,2.6-5.6,2.6-9.1C86.8,40.3,86.3,38,85.2,35.7
11:        L85.2,35.7z M13.1,15.6c0.3-0.3,0.6-0.4,1.1-0.4s0.9,0.1,1.1,0.4c0.3,0.3,0.4,0.6,0.4,1c0,0.3-0.1,0.5-0.2,0.7s-0.3,0.4-0.5,0.5
12:        S14.5,18,14.1,18c-0.3,0-0.6-0.1-0.8-0.2s-0.4-0.3-0.5-0.5s-0.2-0.5-0.2-0.7C12.8,16.2,12.9,15.8,13.1,15.6z M15.6,26.7
13:        c-0.3,0.3-0.7,0.4-1.3,0.4s-1-0.1-1.3-0.4s-0.4-0.7-0.4-1.1c0-0.5,0.1-0.9,0.4-1.1c0.3-0.3,0.7-0.4,1.3-0.4s1,0.1,1.3,0.4
14:        s0.4,0.6,0.4,1.1C16.1,26,15.9,26.4,15.6,26.7z M32.3,16.7c0.4-0.4,1.1-0.6,1.9-0.6c0.9,0,1.5,0.2,1.9,0.6s0.6,1,0.6,1.8
15:        c0,0.5-0.1,0.9-0.3,1.3s-0.5,0.6-0.8,0.8c-0.4,0.2-0.9,0.3-1.5,0.3s-1-0.1-1.4-0.3s-0.7-0.5-0.9-0.8c-0.2-0.4-0.3-0.8-0.3-1.3
16:        C31.7,17.7,31.9,17.2,32.3,16.7z M36.5,35.5c-0.5,0.5-1.2,0.7-2.2,0.7s-1.7-0.2-2.2-0.7s-0.7-1.1-0.7-1.9c0-0.9,0.2-1.5,0.7-1.9
17:        s1.2-0.6,2.2-0.6s1.7,0.2,2.2,0.6s0.7,1.1,0.7,1.9S37,35,36.5,35.5z M60.9,18.4c0.6-0.6,1.5-0.9,2.6-0.9c1.2,0,2,0.3,2.6,0.9
18:        s0.9,1.4,0.9,2.4c0,0.6-0.1,1.2-0.4,1.7s-0.6,0.9-1.1,1.1c-0.5,0.3-1.2,0.4-2,0.4s-1.4-0.1-1.9-0.4s-0.9-0.6-1.2-1.1
19:        S60,21.4,60,20.8C60,19.7,60.3,18.9,60.9,18.4L60.9,18.4z M66.5,43.8c-0.7,0.6-1.7,1-3,1s-2.4-0.3-3-1c-0.7-0.6-1-1.5-1-2.6
20:        c0-1.2,0.3-2,1-2.6s1.7-0.9,3-0.9c1.3,0,2.4,0.3,3,0.9c0.7,0.6,1,1.5,1,2.6S67.2,43.2,66.5,43.8z"/>
21:    <g>
22:        <path class="st0" d="M104.6,45.5c-0.7,0-1.3-0.1-1.7-0.4c-0.5-0.3-0.9-0.7-1.2-1.3c-0.3-0.6-0.4-1.4-0.4-2.5c0-0.7,0-1.6,0-2.7
23:            c0-1.1,0-2.3,0-3.7c0-1.3,0-2.7,0-4.1s0-2.7,0-3.9c0-1.2,0-2.3,0-3.2c0-0.9,0-1.5,0-1.9c0-0.5-0.1-0.8-0.2-0.9
24:            c-0.1-0.2-0.4-0.3-0.9-0.3c-0.7,0-1.3,0-1.9,0s-1,0-1.2,0c-0.6,0-1.2-0.2-1.7-0.5s-0.7-1-0.7-1.9c0-0.6,0.1-1,0.3-1.4
25:            c0.2-0.4,0.7-0.7,1.3-0.9c0.7-0.2,1.6-0.4,2.9-0.5s3-0.1,5-0.1c2.1,0,3.8,0,5.1,0.1c1.3,0.1,2.2,0.2,2.9,0.5
26:            c0.7,0.2,1.1,0.5,1.3,0.9s0.3,0.8,0.3,1.4c0,1-0.2,1.6-0.7,1.9s-1,0.5-1.7,0.5c-0.2,0-0.6,0-1.2,0s-1.2,0-1.9,0
27:            c-0.4,0-0.7,0.1-0.9,0.3c-0.2,0.2-0.3,0.5-0.3,0.9s0,1,0,1.9s0,2,0,3.2s0,2.5,0,3.9s0,2.7,0,4.1s0,2.6,0,3.7c0,1.1,0,2,0,2.7
28:            c0,1-0.1,1.9-0.4,2.5s-0.6,1.1-1.1,1.3C105.8,45.4,105.2,45.5,104.6,45.5z"/>
29:        <path class="st0" d="M133.4,45.7c-2.6,0-5-0.6-7.1-1.9c-2.1-1.2-3.9-3-5.1-5.3c-1.3-2.3-1.9-5.1-1.9-8.3s0.6-5.9,1.9-8.1
30:            s3-3.9,5.1-5.1s4.5-1.7,7.2-1.7c2.6,0,5,0.6,7.2,1.7c2.2,1.2,3.9,2.8,5.2,5s1.9,4.9,1.9,8.1s-0.6,5.9-1.9,8.3
31:            c-1.3,2.3-3,4.1-5.2,5.4C138.5,45,136.1,45.7,133.4,45.7z M133.4,39.9c1.6,0,2.9-0.4,4.1-1.2c1.2-0.8,2.1-1.9,2.7-3.4
32:            c0.7-1.5,1-3.2,1-5.1c0-2-0.3-3.6-1-5s-1.6-2.4-2.8-3.1s-2.5-1.1-4-1.1s-2.8,0.4-4,1.1s-2,1.8-2.7,3.1c-0.6,1.4-1,3-1,5
33:            c0,1.9,0.3,3.6,0.9,5.1s1.5,2.6,2.7,3.4C130.5,39.5,131.9,39.9,133.4,39.9z"/>
34:        <path class="st0" d="M159.3,45.5c-1,0-1.8-0.2-2.3-0.7c-0.6-0.5-1-1.3-1.2-2.6c-0.2-1.9-0.3-4-0.4-6.1c-0.1-2.1-0.1-4-0.1-5.7
35:            s0-3.6,0.1-5.7s0.2-4.1,0.5-6.2c0.2-0.8,0.5-1.5,0.9-1.9c0.4-0.5,1.2-0.8,2.2-1s2.4-0.3,4.2-0.3c2.6,0,4.7,0.3,6.4,1
36:            c1.7,0.7,3,1.7,3.9,3.1s1.3,3,1.3,5.1c0,2-0.4,3.7-1.3,5.1c-0.8,1.4-2.1,2.5-3.7,3.3c-1.6,0.8-3.5,1.2-5.8,1.2c-0.4,0-0.6,0-0.8,0
37:            s-0.4,0-0.6,0c-0.3,0-0.6,0.1-0.7,0.4c-0.1,0.2-0.2,0.5-0.2,0.9c0,0.8,0,1.5,0,2.2s0.1,1.4,0.1,2.2s0,1.8,0,2.9
38:            c0,0.5-0.1,1-0.2,1.5c-0.2,0.5-0.4,0.8-0.8,1.1S160,45.5,159.3,45.5z M162.5,29.2c2.3,0,3.9-0.4,4.9-1.1s1.5-1.9,1.5-3.5
39:            s-0.5-2.6-1.5-3.2s-2.6-0.9-4.9-0.9c-0.3,0-0.6,0-0.7,0.1c-0.2,0.1-0.3,0.3-0.4,0.6c-0.1,0.3-0.2,0.8-0.2,1.5s0,1.7,0,2.9
40:            c0,1.1,0,1.9,0.1,2.3c0.1,0.5,0.2,0.8,0.4,0.9S162.1,29.2,162.5,29.2z"/>
41:        <path class="st0" d="M194.9,45.7c-2.7,0-4.9-0.4-6.7-1.2s-3.2-1.8-4.1-3.2c-0.9-1.3-1.4-2.9-1.4-4.8c0-1.3,0.3-2.5,0.9-3.7
42:            c0.6-1.2,1.4-2.1,2.4-2.8c0.3-0.2,0.6-0.4,0.7-0.6c0.1-0.1,0.2-0.3,0.2-0.4c0-0.2,0-0.4-0.1-0.6s-0.3-0.4-0.6-0.6
43:            c-0.7-0.6-1.2-1.3-1.5-2.2c-0.3-0.9-0.5-1.7-0.5-2.6c0-1.5,0.4-2.9,1.2-4s1.9-2,3.5-2.7c1.6-0.6,3.6-1,6-1s4.3,0.3,5.9,1
44:            c1.6,0.6,2.8,1.5,3.5,2.7c0.8,1.1,1.2,2.5,1.2,4c0,0.9-0.2,1.8-0.5,2.6c-0.3,0.9-0.9,1.6-1.6,2.2c-0.3,0.2-0.5,0.5-0.6,0.6
45:            s-0.1,0.4-0.1,0.6s0,0.3,0.2,0.4c0.1,0.1,0.4,0.3,0.7,0.6c1,0.6,1.9,1.6,2.5,2.8c0.6,1.2,0.9,2.4,0.9,3.7c0,1.8-0.5,3.4-1.4,4.8
46:            c-0.9,1.4-2.3,2.4-4.1,3.2S197.5,45.6,194.9,45.7z M194.9,38c0.8,0,1.4-0.2,1.8-0.6c0.4-0.4,0.6-0.9,0.6-1.6c0-0.7-0.2-1.2-0.6-1.6
47:            s-1-0.6-1.8-0.6s-1.5,0.2-1.9,0.6c-0.4,0.4-0.6,0.9-0.6,1.6c0,0.7,0.2,1.2,0.6,1.6C193.5,37.8,194.1,38,194.9,38z M194.9,26.8
48:            c0.4,0,0.8-0.1,1.1-0.3c0.3-0.2,0.5-0.4,0.7-0.7c0.2-0.3,0.3-0.6,0.3-1c0-0.6-0.2-1.1-0.6-1.4c-0.4-0.3-0.9-0.5-1.5-0.5
49:            c-0.7,0-1.2,0.2-1.6,0.5c-0.4,0.3-0.6,0.8-0.6,1.4c0,0.4,0.1,0.7,0.3,1s0.4,0.5,0.8,0.7C194.1,26.7,194.5,26.8,194.9,26.8z"/>
50:        <path class="st0" d="M218.6,45.4c-1.3,0-2.4-0.4-3.1-1.2c-0.8-0.8-1.2-1.9-1.2-3.2s0.4-2.3,1.2-3.1s1.8-1.2,3.1-1.2
51:            s2.4,0.4,3.1,1.2c0.8,0.8,1.1,1.8,1.1,3.1s-0.4,2.3-1.1,3.2C221,45,219.9,45.4,218.6,45.4z"/>
52:        <path class="st0" d="M234.7,45.6c-1.2,0-2.1-0.2-2.7-0.7c-0.6-0.4-0.9-1.1-0.9-1.9c0-0.5,0.1-1,0.3-1.3s0.6-0.6,1-0.8
53:            s0.9-0.3,1.4-0.4c2.4-0.2,4.2-0.7,5.5-1.4s2-1.6,2-2.8c0-0.7-0.2-1.3-0.7-1.9s-1.1-1.1-1.8-1.6s-1.5-1-2.3-1.5s-1.6-1.1-2.3-1.8
54:            c-0.7-0.7-1.3-1.5-1.8-2.4s-0.7-2-0.7-3.2c0-1.4,0.3-2.6,0.9-3.7c0.6-1.1,1.4-2,2.5-2.7s2.3-1.3,3.6-1.7c1.3-0.4,2.7-0.6,4.1-0.6
55:            c1.3,0,2.2,0.2,2.8,0.6s0.9,1,0.9,1.9c0,0.5-0.1,0.9-0.3,1.3s-0.5,0.6-0.8,0.8c-0.4,0.2-0.8,0.3-1.3,0.3c-2.1,0.1-3.7,0.5-4.7,1.1
56:            s-1.5,1.3-1.5,2.2c0,0.6,0.2,1.2,0.7,1.7s1.1,1,1.8,1.5c0.8,0.5,1.5,1,2.3,1.5s1.6,1.2,2.3,1.8c0.8,0.7,1.4,1.5,1.8,2.4
57:            c0.5,0.9,0.7,2,0.7,3.3c0,1.6-0.4,3-1.1,4.3c-0.7,1.2-1.7,2.2-2.9,3s-2.6,1.4-4.1,1.8C237.9,45.4,236.4,45.6,234.7,45.6z"/>
58:        <path class="st0" d="M260.2,45.5c-1,0-1.8-0.2-2.3-0.7c-0.6-0.5-1-1.3-1.2-2.6c-0.2-1.9-0.3-4-0.4-6.1s-0.1-4-0.1-5.7
59:            s0-3.6,0.1-5.7s0.2-4.1,0.5-6.2c0.2-0.8,0.5-1.5,0.9-1.9c0.4-0.5,1.2-0.8,2.2-1s2.4-0.3,4.2-0.3c2.6,0,4.7,0.3,6.4,1
60:            c1.7,0.7,3,1.7,3.9,3.1s1.3,3,1.3,5.1c0,2-0.4,3.7-1.3,5.1c-0.8,1.4-2.1,2.5-3.7,3.3c-1.6,0.8-3.5,1.2-5.8,1.2c-0.4,0-0.6,0-0.8,0
61:            c-0.2,0-0.4,0-0.6,0c-0.3,0-0.6,0.1-0.7,0.4c-0.1,0.2-0.2,0.5-0.2,0.9c0,0.8,0,1.5,0,2.2s0.1,1.4,0.1,2.2s0,1.8,0,2.9
62:            c0,0.5-0.1,1-0.2,1.5c-0.2,0.5-0.4,0.8-0.8,1.1S260.9,45.5,260.2,45.5z M263.4,29.2c2.3,0,3.9-0.4,4.9-1.1s1.5-1.9,1.5-3.5
63:            s-0.5-2.6-1.5-3.2s-2.6-0.9-4.9-0.9c-0.3,0-0.6,0-0.7,0.1c-0.2,0.1-0.3,0.3-0.4,0.6c-0.1,0.3-0.2,0.8-0.2,1.5s0,1.7,0,2.9
64:            c0,1.1,0,1.9,0.1,2.3c0.1,0.5,0.2,0.8,0.4,0.9C262.7,29.2,263,29.2,263.4,29.2z"/>
65:        <path class="st0" d="M282.4,45.6c-0.7,0-1.3-0.1-1.7-0.4c-0.4-0.2-0.8-0.6-1-1.1s-0.3-1.1-0.3-1.8c0-1,0.1-2.3,0.4-4
66:            c0.3-1.6,0.6-3.4,1.1-5.4c0.4-1.9,1-3.9,1.5-5.8c0.7-2.4,1.4-4.3,2-5.8s1.3-2.7,1.9-3.6s1.3-1.5,2-1.9s1.5-0.5,2.4-0.5
67:            c1,0,1.8,0.2,2.5,0.6c0.7,0.4,1.4,1,2,1.9s1.2,2.1,1.8,3.6c0.6,1.5,1.2,3.4,1.9,5.7c0.6,2,1.2,3.9,1.6,5.9s0.8,3.8,1.1,5.4
68:            c0.3,1.6,0.4,2.9,0.4,3.9c0,0.7-0.1,1.3-0.3,1.8c-0.2,0.5-0.5,0.9-1,1.1c-0.4,0.2-1,0.3-1.7,0.3c-0.6,0-1-0.1-1.4-0.3
69:            s-0.7-0.6-1-1.1s-0.5-1.1-0.6-1.8c-0.2-1.3-0.5-2.3-0.6-3.1c-0.2-0.8-0.3-1.3-0.4-1.7s-0.3-0.7-0.4-0.9s-0.3-0.4-0.5-0.5
70:            s-0.5-0.2-1-0.2s-1.3-0.1-2.5-0.1c-1.1,0-1.9,0-2.4,0.1c-0.5,0-0.9,0.1-1.1,0.3c-0.2,0.1-0.3,0.3-0.5,0.6s-0.3,0.7-0.4,1
71:            c-0.1,0.4-0.3,0.9-0.4,1.6c-0.1,0.7-0.3,1.7-0.6,3c-0.2,0.7-0.4,1.3-0.6,1.8c-0.3,0.5-0.6,0.8-0.9,1.1S282.9,45.6,282.4,45.6z
72:             M290.8,31.2c0.4,0,0.8,0,1.2,0s0.7,0,1,0c0.4,0,0.6-0.1,0.7-0.2s0.2-0.3,0.2-0.6c0-0.5-0.1-1.2-0.3-1.9s-0.5-1.6-0.7-2.5
73:            c-0.4-1.4-0.7-2.4-1-3c-0.2-0.7-0.5-1.1-0.6-1.3c-0.2-0.2-0.4-0.3-0.6-0.3s-0.4,0.1-0.5,0.3c-0.2,0.2-0.4,0.6-0.6,1.3
74:            c-0.2,0.6-0.5,1.6-0.9,3c-0.2,0.8-0.4,1.6-0.7,2.4c-0.2,0.8-0.3,1.5-0.3,2c0,0.3,0.1,0.5,0.2,0.6s0.3,0.2,0.7,0.2
75:            c0.4,0,0.8,0,1.2,0C290,31.2,290.4,31.2,290.8,31.2z"/>
76:        <path class="st0" d="M321.8,45.7c-1.5,0-3.1-0.3-4.7-0.9c-1.7-0.6-3.2-1.5-4.6-2.8s-2.6-2.8-3.5-4.7s-1.3-4.1-1.3-6.7
77:            s0.5-4.9,1.4-6.8s2.1-3.5,3.5-4.7c1.5-1.2,3-2.2,4.7-2.8c1.7-0.6,3.2-0.9,4.7-0.9c1.3,0,2.1,0.2,2.7,0.6c0.5,0.4,0.8,1,0.8,1.7
78:            c0,0.9-0.3,1.5-0.8,1.9c-0.6,0.4-1.3,0.7-2.2,0.9c-0.9,0.2-1.9,0.6-2.9,1s-2.1,1.1-3,2.1c-1.7,1.7-2.5,4-2.5,6.8
79:            c0,2.7,0.8,4.9,2.5,6.6c0.8,0.8,1.6,1.4,2.4,1.8c0.8,0.4,1.6,0.7,2.3,0.9c0.7,0.2,1.4,0.4,2,0.6c0.6,0.2,1.1,0.5,1.4,0.9
80:            s0.5,1,0.5,1.8s-0.3,1.5-0.8,2C323.7,45.4,322.9,45.7,321.8,45.7z"/>
81:        <path class="st0" d="M342.1,45.6c-1.8,0-3.2-0.1-4.2-0.2c-1-0.2-1.8-0.4-2.3-0.7s-0.9-0.7-1.1-1.1c-0.2-0.3-0.3-1.2-0.4-2.4
82:            c-0.1-1.3-0.2-2.9-0.3-4.8c-0.1-1.9-0.1-3.9-0.1-6.1c0-2.3,0-4.4,0.1-6.3c0.1-1.9,0.2-3.4,0.3-4.6c0.1-1.2,0.3-2,0.4-2.3
83:            c0.2-0.5,0.6-0.8,1.1-1.1c0.5-0.2,1.2-0.4,2.2-0.5s2.3-0.1,4-0.1c2.5,0,4.5,0.1,5.9,0.3s2.4,0.5,2.9,0.9c0.6,0.4,0.9,1,0.9,1.8
84:            s-0.2,1.4-0.6,1.9c-0.4,0.4-1.1,0.6-2.1,0.6c-0.6,0-1.4,0-2.3,0s-1.8,0-2.7-0.1c-0.9,0-1.7,0-2.5,0c-0.5,0-0.9,0.1-1.1,0.2
85:            s-0.3,0.5-0.3,1.1s-0.1,1.2-0.1,1.9s0,1.2,0,1.8c0,0.6,0.1,0.9,0.3,1.1c0.2,0.1,0.6,0.2,1,0.2c0.9,0,1.7,0,2.3,0c0.7,0,1.3,0,2,0
86:            s1.4,0,2.2,0c1.2,0,2.1,0.2,2.5,0.7c0.4,0.4,0.6,1.1,0.6,2s-0.2,1.6-0.7,2s-1.2,0.7-2.3,0.7c-1,0-2.1,0-3.4,0s-2.5,0-3.7,0
87:            c-0.6,0-0.8,0.3-0.8,0.8c0,0.7,0,1.4,0,2c0,0.7,0,1.3,0,1.9c0,0.6,0,1.1,0,1.5s0,0.6,0,0.7c0.1,0.4,0.2,0.7,0.3,0.9
88:            c0.1,0.2,0.4,0.3,0.8,0.3c1.2,0,2.4,0,3.5,0s2,0,2.8,0s1.3,0,1.6,0c0.6,0,1.2,0.2,1.7,0.5s0.7,0.9,0.7,1.7c0,0.5-0.1,1-0.4,1.4
89:            c-0.2,0.4-0.7,0.7-1.3,1s-1.6,0.5-2.7,0.6C345.5,45.5,344,45.6,342.1,45.6z"/>
90:    </g>
91:    </svg>
</file>

<file path="images/top8.svg">
 1: <?xml version="1.0" encoding="utf-8"?>
 2: <!-- Generator: Adobe Illustrator 27.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
 3: <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
 4: 	 viewBox="0 0 360.1 63.2" style="enable-background:new 0 0 360.1 63.2;" xml:space="preserve" fill="currentColor">
 5: <path class="st0" d="M85.2,35.7c-1.1-2.3-2.6-4-4.5-5.3c-0.6-0.5-1.1-0.8-1.4-1.1s-0.4-0.6-0.4-0.9c0-0.4,0.1-0.8,0.3-1.1
 6: 	c0.2-0.4,0.6-0.8,1.2-1.2c1.3-1.2,2.2-2.6,2.9-4.2c0.6-1.6,1-3.3,1-4.9c0-2.9-0.8-5.5-2.3-7.7s-3.8-3.9-6.9-5.1s-6.9-1.8-11.6-1.8
 7: 	S54.9,3,51.9,4.2c-2.5,1-4.4,2.3-5.9,3.9c-0.9-0.7-1.9-1.3-3.2-1.8c-2.3-0.9-5.1-1.4-8.6-1.4s-6.3,0.5-8.6,1.4s-3.9,2.2-5.1,3.8
 8: 	l-1.2-0.6c-1.3-0.5-3-0.8-5.1-0.8c-2,0-3.7,0.3-5.1,0.8c-1.3,0.5-2.3,1.3-3,2.2c-0.7,1-1,2.1-1,3.4c0,0.7,0.1,1.4,0.4,2.1
 9: 	s0.7,1.3,1.3,1.8c0.3,0.2,0.4,0.4,0.5,0.5s0.1,0.3,0.1,0.5c0,0.1-0.1,0.3-0.2,0.4s-0.3,0.3-0.6,0.5c-0.8,0.5-1.4,1.3-1.9,2.3
10: 	S4,25.2,4,26.3c0,1.5,0.4,2.8,1.1,4c0.8,1.1,1.9,2,3.4,2.7s3.4,1,5.6,1c1,0,1.9-0.1,2.8-0.2c0,0.4-0.1,0.8-0.1,1.1
11: 	c0,2.5,0.6,4.8,1.9,6.7s3.2,3.4,5.8,4.5s5.7,1.6,9.5,1.7c2.4,0,4.5-0.3,6.4-0.7c0.4,1.8,1.1,3.4,2.1,4.9c1.8,2.6,4.4,4.6,7.8,6.1
12: 	c3.5,1.5,7.8,2.2,12.8,2.3c5.1-0.1,9.4-0.8,12.9-2.3c3.4-1.5,6.1-3.5,7.8-6.1c1.8-2.6,2.6-5.6,2.6-9.1C86.8,40.3,86.3,38,85.2,35.7
13: 	L85.2,35.7z M13.1,15.6c0.3-0.3,0.6-0.4,1.1-0.4s0.9,0.1,1.1,0.4c0.3,0.3,0.4,0.6,0.4,1c0,0.3-0.1,0.5-0.2,0.7s-0.3,0.4-0.5,0.5
14: 	S14.5,18,14.1,18c-0.3,0-0.6-0.1-0.8-0.2s-0.4-0.3-0.5-0.5s-0.2-0.5-0.2-0.7C12.8,16.2,12.9,15.8,13.1,15.6z M15.6,26.7
15: 	c-0.3,0.3-0.7,0.4-1.3,0.4s-1-0.1-1.3-0.4s-0.4-0.7-0.4-1.1c0-0.5,0.1-0.9,0.4-1.1c0.3-0.3,0.7-0.4,1.3-0.4s1,0.1,1.3,0.4
16: 	s0.4,0.6,0.4,1.1C16.1,26,15.9,26.4,15.6,26.7z M32.3,16.7c0.4-0.4,1.1-0.6,1.9-0.6c0.9,0,1.5,0.2,1.9,0.6s0.6,1,0.6,1.8
17: 	c0,0.5-0.1,0.9-0.3,1.3s-0.5,0.6-0.8,0.8c-0.4,0.2-0.9,0.3-1.5,0.3s-1-0.1-1.4-0.3s-0.7-0.5-0.9-0.8c-0.2-0.4-0.3-0.8-0.3-1.3
18: 	C31.7,17.7,31.9,17.2,32.3,16.7z M36.5,35.5c-0.5,0.5-1.2,0.7-2.2,0.7s-1.7-0.2-2.2-0.7s-0.7-1.1-0.7-1.9c0-0.9,0.2-1.5,0.7-1.9
19: 	s1.2-0.6,2.2-0.6s1.7,0.2,2.2,0.6s0.7,1.1,0.7,1.9S37,35,36.5,35.5z M60.9,18.4c0.6-0.6,1.5-0.9,2.6-0.9c1.2,0,2,0.3,2.6,0.9
20: 	s0.9,1.4,0.9,2.4c0,0.6-0.1,1.2-0.4,1.7s-0.6,0.9-1.1,1.1c-0.5,0.3-1.2,0.4-2,0.4s-1.4-0.1-1.9-0.4s-0.9-0.6-1.2-1.1
21: 	S60,21.4,60,20.8C60,19.7,60.3,18.9,60.9,18.4L60.9,18.4z M66.5,43.8c-0.7,0.6-1.7,1-3,1s-2.4-0.3-3-1c-0.7-0.6-1-1.5-1-2.6
22: 	c0-1.2,0.3-2,1-2.6s1.7-0.9,3-0.9c1.3,0,2.4,0.3,3,0.9c0.7,0.6,1,1.5,1,2.6S67.2,43.2,66.5,43.8z"/>
23: <g>
24: 	<path class="st0" fill="currentColor" d="M104.6,45.5c-0.7,0-1.3-0.1-1.7-0.4c-0.5-0.3-0.9-0.7-1.2-1.3c-0.3-0.6-0.4-1.4-0.4-2.5c0-0.7,0-1.6,0-2.7
25: 		c0-1.1,0-2.3,0-3.7c0-1.3,0-2.7,0-4.1s0-2.7,0-3.9c0-1.2,0-2.3,0-3.2c0-0.9,0-1.5,0-1.9c0-0.5-0.1-0.8-0.2-0.9
26: 		c-0.1-0.2-0.4-0.3-0.9-0.3c-0.7,0-1.3,0-1.9,0s-1,0-1.2,0c-0.6,0-1.2-0.2-1.7-0.5s-0.7-1-0.7-1.9c0-0.6,0.1-1,0.3-1.4
27: 		c0.2-0.4,0.7-0.7,1.3-0.9c0.7-0.2,1.6-0.4,2.9-0.5s3-0.1,5-0.1c2.1,0,3.8,0,5.1,0.1c1.3,0.1,2.2,0.2,2.9,0.5
28: 		c0.7,0.2,1.1,0.5,1.3,0.9s0.3,0.8,0.3,1.4c0,1-0.2,1.6-0.7,1.9s-1,0.5-1.7,0.5c-0.2,0-0.6,0-1.2,0s-1.2,0-1.9,0
29: 		c-0.4,0-0.7,0.1-0.9,0.3c-0.2,0.2-0.3,0.5-0.3,0.9s0,1,0,1.9s0,2,0,3.2s0,2.5,0,3.9s0,2.7,0,4.1s0,2.6,0,3.7c0,1.1,0,2,0,2.7
30: 		c0,1-0.1,1.9-0.4,2.5s-0.6,1.1-1.1,1.3C105.8,45.4,105.2,45.5,104.6,45.5z"/>
31: 	<path class="st0" fill="currentColor" d="M133.4,45.7c-2.6,0-5-0.6-7.1-1.9c-2.1-1.2-3.9-3-5.1-5.3c-1.3-2.3-1.9-5.1-1.9-8.3s0.6-5.9,1.9-8.1
32: 		s3-3.9,5.1-5.1s4.5-1.7,7.2-1.7c2.6,0,5,0.6,7.2,1.7c2.2,1.2,3.9,2.8,5.2,5s1.9,4.9,1.9,8.1s-0.6,5.9-1.9,8.3
33: 		c-1.3,2.3-3,4.1-5.2,5.4C138.5,45,136.1,45.7,133.4,45.7z M133.4,39.9c1.6,0,2.9-0.4,4.1-1.2c1.2-0.8,2.1-1.9,2.7-3.4
34: 		c0.7-1.5,1-3.2,1-5.1c0-2-0.3-3.6-1-5s-1.6-2.4-2.8-3.1s-2.5-1.1-4-1.1s-2.8,0.4-4,1.1s-2,1.8-2.7,3.1c-0.6,1.4-1,3-1,5
35: 		c0,1.9,0.3,3.6,0.9,5.1s1.5,2.6,2.7,3.4C130.5,39.5,131.9,39.9,133.4,39.9z"/>
36: 	<path class="st0" fill="currentColor" d="M159.3,45.5c-1,0-1.8-0.2-2.3-0.7c-0.6-0.5-1-1.3-1.2-2.6c-0.2-1.9-0.3-4-0.4-6.1c-0.1-2.1-0.1-4-0.1-5.7
37: 		s0-3.6,0.1-5.7s0.2-4.1,0.5-6.2c0.2-0.8,0.5-1.5,0.9-1.9c0.4-0.5,1.2-0.8,2.2-1s2.4-0.3,4.2-0.3c2.6,0,4.7,0.3,6.4,1
38: 		c1.7,0.7,3,1.7,3.9,3.1s1.3,3,1.3,5.1c0,2-0.4,3.7-1.3,5.1c-0.8,1.4-2.1,2.5-3.7,3.3c-1.6,0.8-3.5,1.2-5.8,1.2c-0.4,0-0.6,0-0.8,0
39: 		s-0.4,0-0.6,0c-0.3,0-0.6,0.1-0.7,0.4c-0.1,0.2-0.2,0.5-0.2,0.9c0,0.8,0,1.5,0,2.2s0.1,1.4,0.1,2.2s0,1.8,0,2.9
40: 		c0,0.5-0.1,1-0.2,1.5c-0.2,0.5-0.4,0.8-0.8,1.1S160,45.5,159.3,45.5z M162.5,29.2c2.3,0,3.9-0.4,4.9-1.1s1.5-1.9,1.5-3.5
41: 		s-0.5-2.6-1.5-3.2s-2.6-0.9-4.9-0.9c-0.3,0-0.6,0-0.7,0.1c-0.2,0.1-0.3,0.3-0.4,0.6c-0.1,0.3-0.2,0.8-0.2,1.5s0,1.7,0,2.9
42: 		c0,1.1,0,1.9,0.1,2.3c0.1,0.5,0.2,0.8,0.4,0.9S162.1,29.2,162.5,29.2z"/>
43: 	<path class="st0" d="M194.9,45.7c-2.7,0-4.9-0.4-6.7-1.2s-3.2-1.8-4.1-3.2c-0.9-1.3-1.4-2.9-1.4-4.8c0-1.3,0.3-2.5,0.9-3.7
44: 		c0.6-1.2,1.4-2.1,2.4-2.8c0.3-0.2,0.6-0.4,0.7-0.6c0.1-0.1,0.2-0.3,0.2-0.4c0-0.2,0-0.4-0.1-0.6s-0.3-0.4-0.6-0.6
45: 		c-0.7-0.6-1.2-1.3-1.5-2.2c-0.3-0.9-0.5-1.7-0.5-2.6c0-1.5,0.4-2.9,1.2-4s1.9-2,3.5-2.7c1.6-0.6,3.6-1,6-1s4.3,0.3,5.9,1
46: 		c1.6,0.6,2.8,1.5,3.5,2.7c0.8,1.1,1.2,2.5,1.2,4c0,0.9-0.2,1.8-0.5,2.6c-0.3,0.9-0.9,1.6-1.6,2.2c-0.3,0.2-0.5,0.5-0.6,0.6
47: 		s-0.1,0.4-0.1,0.6s0,0.3,0.2,0.4c0.1,0.1,0.4,0.3,0.7,0.6c1,0.6,1.9,1.6,2.5,2.8c0.6,1.2,0.9,2.4,0.9,3.7c0,1.8-0.5,3.4-1.4,4.8
48: 		c-0.9,1.4-2.3,2.4-4.1,3.2S197.5,45.6,194.9,45.7z M194.9,38c0.8,0,1.4-0.2,1.8-0.6c0.4-0.4,0.6-0.9,0.6-1.6c0-0.7-0.2-1.2-0.6-1.6
49: 		s-1-0.6-1.8-0.6s-1.5,0.2-1.9,0.6c-0.4,0.4-0.6,0.9-0.6,1.6c0,0.7,0.2,1.2,0.6,1.6C193.5,37.8,194.1,38,194.9,38z M194.9,26.8
50: 		c0.4,0,0.8-0.1,1.1-0.3c0.3-0.2,0.5-0.4,0.7-0.7c0.2-0.3,0.3-0.6,0.3-1c0-0.6-0.2-1.1-0.6-1.4c-0.4-0.3-0.9-0.5-1.5-0.5
51: 		c-0.7,0-1.2,0.2-1.6,0.5c-0.4,0.3-0.6,0.8-0.6,1.4c0,0.4,0.1,0.7,0.3,1s0.4,0.5,0.8,0.7C194.1,26.7,194.5,26.8,194.9,26.8z"/>
52: 	<path class="st0" d="M218.6,45.4c-1.3,0-2.4-0.4-3.1-1.2c-0.8-0.8-1.2-1.9-1.2-3.2s0.4-2.3,1.2-3.1s1.8-1.2,3.1-1.2
53: 		s2.4,0.4,3.1,1.2c0.8,0.8,1.1,1.8,1.1,3.1s-0.4,2.3-1.1,3.2C221,45,219.9,45.4,218.6,45.4z"/>
54: 	<path class="st0" d="M234.7,45.6c-1.2,0-2.1-0.2-2.7-0.7c-0.6-0.4-0.9-1.1-0.9-1.9c0-0.5,0.1-1,0.3-1.3s0.6-0.6,1-0.8
55: 		s0.9-0.3,1.4-0.4c2.4-0.2,4.2-0.7,5.5-1.4s2-1.6,2-2.8c0-0.7-0.2-1.3-0.7-1.9s-1.1-1.1-1.8-1.6s-1.5-1-2.3-1.5s-1.6-1.1-2.3-1.8
56: 		c-0.7-0.7-1.3-1.5-1.8-2.4s-0.7-2-0.7-3.2c0-1.4,0.3-2.6,0.9-3.7c0.6-1.1,1.4-2,2.5-2.7s2.3-1.3,3.6-1.7c1.3-0.4,2.7-0.6,4.1-0.6
57: 		c1.3,0,2.2,0.2,2.8,0.6s0.9,1,0.9,1.9c0,0.5-0.1,0.9-0.3,1.3s-0.5,0.6-0.8,0.8c-0.4,0.2-0.8,0.3-1.3,0.3c-2.1,0.1-3.7,0.5-4.7,1.1
58: 		s-1.5,1.3-1.5,2.2c0,0.6,0.2,1.2,0.7,1.7s1.1,1,1.8,1.5c0.8,0.5,1.5,1,2.3,1.5s1.6,1.2,2.3,1.8c0.8,0.7,1.4,1.5,1.8,2.4
59: 		c0.5,0.9,0.7,2,0.7,3.3c0,1.6-0.4,3-1.1,4.3c-0.7,1.2-1.7,2.2-2.9,3s-2.6,1.4-4.1,1.8C237.9,45.4,236.4,45.6,234.7,45.6z"/>
60: 	<path class="st0" d="M260.2,45.5c-1,0-1.8-0.2-2.3-0.7c-0.6-0.5-1-1.3-1.2-2.6c-0.2-1.9-0.3-4-0.4-6.1s-0.1-4-0.1-5.7
61: 		s0-3.6,0.1-5.7s0.2-4.1,0.5-6.2c0.2-0.8,0.5-1.5,0.9-1.9c0.4-0.5,1.2-0.8,2.2-1s2.4-0.3,4.2-0.3c2.6,0,4.7,0.3,6.4,1
62: 		c1.7,0.7,3,1.7,3.9,3.1s1.3,3,1.3,5.1c0,2-0.4,3.7-1.3,5.1c-0.8,1.4-2.1,2.5-3.7,3.3c-1.6,0.8-3.5,1.2-5.8,1.2c-0.4,0-0.6,0-0.8,0
63: 		c-0.2,0-0.4,0-0.6,0c-0.3,0-0.6,0.1-0.7,0.4c-0.1,0.2-0.2,0.5-0.2,0.9c0,0.8,0,1.5,0,2.2s0.1,1.4,0.1,2.2s0,1.8,0,2.9
64: 		c0,0.5-0.1,1-0.2,1.5c-0.2,0.5-0.4,0.8-0.8,1.1S260.9,45.5,260.2,45.5z M263.4,29.2c2.3,0,3.9-0.4,4.9-1.1s1.5-1.9,1.5-3.5
65: 		s-0.5-2.6-1.5-3.2s-2.6-0.9-4.9-0.9c-0.3,0-0.6,0-0.7,0.1c-0.2,0.1-0.3,0.3-0.4,0.6c-0.1,0.3-0.2,0.8-0.2,1.5s0,1.7,0,2.9
66: 		c0,1.1,0,1.9,0.1,2.3c0.1,0.5,0.2,0.8,0.4,0.9C262.7,29.2,263,29.2,263.4,29.2z"/>
67: 	<path class="st0" d="M282.4,45.6c-0.7,0-1.3-0.1-1.7-0.4c-0.4-0.2-0.8-0.6-1-1.1s-0.3-1.1-0.3-1.8c0-1,0.1-2.3,0.4-4
68: 		c0.3-1.6,0.6-3.4,1.1-5.4c0.4-1.9,1-3.9,1.5-5.8c0.7-2.4,1.4-4.3,2-5.8s1.3-2.7,1.9-3.6s1.3-1.5,2-1.9s1.5-0.5,2.4-0.5
69: 		c1,0,1.8,0.2,2.5,0.6c0.7,0.4,1.4,1,2,1.9s1.2,2.1,1.8,3.6c0.6,1.5,1.2,3.4,1.9,5.7c0.6,2,1.2,3.9,1.6,5.9s0.8,3.8,1.1,5.4
70: 		c0.3,1.6,0.4,2.9,0.4,3.9c0,0.7-0.1,1.3-0.3,1.8c-0.2,0.5-0.5,0.9-1,1.1c-0.4,0.2-1,0.3-1.7,0.3c-0.6,0-1-0.1-1.4-0.3
71: 		s-0.7-0.6-1-1.1s-0.5-1.1-0.6-1.8c-0.2-1.3-0.5-2.3-0.6-3.1c-0.2-0.8-0.3-1.3-0.4-1.7s-0.3-0.7-0.4-0.9s-0.3-0.4-0.5-0.5
72: 		s-0.5-0.2-1-0.2s-1.3-0.1-2.5-0.1c-1.1,0-1.9,0-2.4,0.1c-0.5,0-0.9,0.1-1.1,0.3c-0.2,0.1-0.3,0.3-0.5,0.6s-0.3,0.7-0.4,1
73: 		c-0.1,0.4-0.3,0.9-0.4,1.6c-0.1,0.7-0.3,1.7-0.6,3c-0.2,0.7-0.4,1.3-0.6,1.8c-0.3,0.5-0.6,0.8-0.9,1.1S282.9,45.6,282.4,45.6z
74: 		 M290.8,31.2c0.4,0,0.8,0,1.2,0s0.7,0,1,0c0.4,0,0.6-0.1,0.7-0.2s0.2-0.3,0.2-0.6c0-0.5-0.1-1.2-0.3-1.9s-0.5-1.6-0.7-2.5
75: 		c-0.4-1.4-0.7-2.4-1-3c-0.2-0.7-0.5-1.1-0.6-1.3c-0.2-0.2-0.4-0.3-0.6-0.3s-0.4,0.1-0.5,0.3c-0.2,0.2-0.4,0.6-0.6,1.3
76: 		c-0.2,0.6-0.5,1.6-0.9,3c-0.2,0.8-0.4,1.6-0.7,2.4c-0.2,0.8-0.3,1.5-0.3,2c0,0.3,0.1,0.5,0.2,0.6s0.3,0.2,0.7,0.2
77: 		c0.4,0,0.8,0,1.2,0C290,31.2,290.4,31.2,290.8,31.2z"/>
78: 	<path class="st0" d="M321.8,45.7c-1.5,0-3.1-0.3-4.7-0.9c-1.7-0.6-3.2-1.5-4.6-2.8s-2.6-2.8-3.5-4.7s-1.3-4.1-1.3-6.7
79: 		s0.5-4.9,1.4-6.8s2.1-3.5,3.5-4.7c1.5-1.2,3-2.2,4.7-2.8c1.7-0.6,3.2-0.9,4.7-0.9c1.3,0,2.1,0.2,2.7,0.6c0.5,0.4,0.8,1,0.8,1.7
80: 		c0,0.9-0.3,1.5-0.8,1.9c-0.6,0.4-1.3,0.7-2.2,0.9c-0.9,0.2-1.9,0.6-2.9,1s-2.1,1.1-3,2.1c-1.7,1.7-2.5,4-2.5,6.8
81: 		c0,2.7,0.8,4.9,2.5,6.6c0.8,0.8,1.6,1.4,2.4,1.8c0.8,0.4,1.6,0.7,2.3,0.9c0.7,0.2,1.4,0.4,2,0.6c0.6,0.2,1.1,0.5,1.4,0.9
82: 		s0.5,1,0.5,1.8s-0.3,1.5-0.8,2C323.7,45.4,322.9,45.7,321.8,45.7z"/>
83: 	<path class="st0" d="M342.1,45.6c-1.8,0-3.2-0.1-4.2-0.2c-1-0.2-1.8-0.4-2.3-0.7s-0.9-0.7-1.1-1.1c-0.2-0.3-0.3-1.2-0.4-2.4
84: 		c-0.1-1.3-0.2-2.9-0.3-4.8c-0.1-1.9-0.1-3.9-0.1-6.1c0-2.3,0-4.4,0.1-6.3c0.1-1.9,0.2-3.4,0.3-4.6c0.1-1.2,0.3-2,0.4-2.3
85: 		c0.2-0.5,0.6-0.8,1.1-1.1c0.5-0.2,1.2-0.4,2.2-0.5s2.3-0.1,4-0.1c2.5,0,4.5,0.1,5.9,0.3s2.4,0.5,2.9,0.9c0.6,0.4,0.9,1,0.9,1.8
86: 		s-0.2,1.4-0.6,1.9c-0.4,0.4-1.1,0.6-2.1,0.6c-0.6,0-1.4,0-2.3,0s-1.8,0-2.7-0.1c-0.9,0-1.7,0-2.5,0c-0.5,0-0.9,0.1-1.1,0.2
87: 		s-0.3,0.5-0.3,1.1s-0.1,1.2-0.1,1.9s0,1.2,0,1.8c0,0.6,0.1,0.9,0.3,1.1c0.2,0.1,0.6,0.2,1,0.2c0.9,0,1.7,0,2.3,0c0.7,0,1.3,0,2,0
88: 		s1.4,0,2.2,0c1.2,0,2.1,0.2,2.5,0.7c0.4,0.4,0.6,1.1,0.6,2s-0.2,1.6-0.7,2s-1.2,0.7-2.3,0.7c-1,0-2.1,0-3.4,0s-2.5,0-3.7,0
89: 		c-0.6,0-0.8,0.3-0.8,0.8c0,0.7,0,1.4,0,2c0,0.7,0,1.3,0,1.9c0,0.6,0,1.1,0,1.5s0,0.6,0,0.7c0.1,0.4,0.2,0.7,0.3,0.9
90: 		c0.1,0.2,0.4,0.3,0.8,0.3c1.2,0,2.4,0,3.5,0s2,0,2.8,0s1.3,0,1.6,0c0.6,0,1.2,0.2,1.7,0.5s0.7,0.9,0.7,1.7c0,0.5-0.1,1-0.4,1.4
91: 		c-0.2,0.4-0.7,0.7-1.3,1s-1.6,0.5-2.7,0.6C345.5,45.5,344,45.6,342.1,45.6z"/>
92: </g>
93: </svg>
</file>

<file path="js/alpine-integration.js">
  1: document.addEventListener("alpine:init", () => {
  2:     // Create instances of our managers
  3:     const authManager = new AuthManager();
  4:     const profileManager = new ProfileManager(authManager);
  5:     const themeManager = new PDSThemeManager(authManager);
  6:     const postsManager = new PostManager();
  7:     const top8Manager = new Top8Manager(authManager);
  8: 
  9:     // Initialize the store
 10:     Alpine.store("person", {});
 11: 
 12:     Alpine.store("state", {
 13:         person: {},
 14:         posts: [],
 15:         top8Friends: [],
 16:         setPerson(person) {
 17:             this.person = person;
 18:         },
 19:         setTop8Friends(friends) {
 20:             this.top8Friends = friends;
 21:         },
 22:     });
 23: 
 24:     // Register the theme component
 25:     Alpine.data("theme", () => ({
 26:         colorThemes: [],
 27:         themeClass: {},
 28:         currentTheme: null,
 29: 
 30:         async init() {
 31:             this.colorThemes = themeManager.colorThemes;
 32:             // Set a default theme immediately
 33:             this.themeClass = themeManager.getThemeClasses();
 34:             document.body.className = themeManager.colorThemes[0];
 35: 
 36:             // If we have a logged-in user, initialize their theme
 37:             const storedPerson = Alpine.store("person");
 38:             if (storedPerson?.bsky_handle) {
 39:                 try {
 40:                     await themeManager.initialize();
 41:                     this.themeClass = themeManager.getThemeClasses();
 42:                 } catch (error) {
 43:                     console.error("Failed to initialize theme:", error);
 44:                 }
 45:             }
 46:         },
 47: 
 48:         validateTheme(themeName) {
 49:             return themeManager.validateTheme(themeName);
 50:         },
 51: 
 52:         choiceClass(themeName) {
 53:             return themeManager.choiceClass(themeName);
 54:         },
 55: 
 56:         async changeTheme(themeName) {
 57:             try {
 58:                 const result = await themeManager.setTheme(themeName);
 59:                 this.themeClass = result;
 60:             } catch (error) {
 61:                 console.error("Failed to change theme:", error);
 62:             }
 63:         },
 64:     }));
 65: 
 66:     // Register the Top8 component
 67:     Alpine.data("top8", () => ({
 68:         friends: [],
 69:         searchQuery: "",
 70:         searchResults: [],
 71:         selectedFriends: [],
 72:         showDialog: false,
 73:         loading: false,
 74:         error: null,
 75: 
 76:         async init() {
 77:             if (this.$store.person?.bsky_handle) {
 78:                 await this.loadFriends();
 79:             }
 80: 
 81:             // Watch for person changes to reload friends
 82:             this.$watch("$store.person", async (person) => {
 83:                 if (person?.bsky_handle) {
 84:                     await this.loadFriends();
 85:                 } else {
 86:                     this.friends = [];
 87:                 }
 88:             });
 89:         },
 90: 
 91:         async loadFriends() {
 92:             try {
 93:                 this.loading = true;
 94:                 this.error = null;
 95:                 const friends = await top8Manager.initialize();
 96:                 this.friends = friends;
 97:                 this.selectedFriends = [...friends]; // Copy current friends to selected
 98:                 Alpine.store("state").setTop8Friends(friends);
 99:             } catch (error) {
100:                 console.error("Failed to load friends:", error);
101:                 this.error = "Failed to load friends: " + error.message;
102:             } finally {
103:                 this.loading = false;
104:             }
105:         },
106: 
107:         async searchFriends() {
108:             if (!this.searchQuery.trim()) {
109:                 this.searchResults = [];
110:                 return;
111:             }
112: 
113:             try {
114:                 this.loading = true;
115:                 this.error = null;
116:                 this.searchResults = await top8Manager.searchFollows(
117:                     this.searchQuery,
118:                 );
119:             } catch (error) {
120:                 console.error("Search failed:", error);
121:                 this.error = "Search failed: " + error.message;
122:             } finally {
123:                 this.loading = false;
124:             }
125:         },
126: 
127:         toggleFriend(friend) {
128:             const index = this.selectedFriends.findIndex(
129:                 (f) => f.did === friend.did,
130:             );
131:             if (index === -1) {
132:                 if (this.selectedFriends.length >= 8) {
133:                     this.error = "Maximum 8 friends allowed";
134:                     return;
135:                 }
136:                 this.selectedFriends.push(friend);
137:             } else {
138:                 this.selectedFriends.splice(index, 1);
139:             }
140:         },
141: 
142:         isFriendSelected(friend) {
143:             return this.selectedFriends.some((f) => f.did === friend.did);
144:         },
145: 
146:         async saveFriends() {
147:             try {
148:                 this.loading = true;
149:                 this.error = null;
150:                 await top8Manager.saveFriends(this.selectedFriends);
151:                 this.friends = [...this.selectedFriends];
152:                 Alpine.store("state").setTop8Friends(this.friends);
153:                 this.showDialog = false;
154:             } catch (error) {
155:                 console.error("Failed to save friends:", error);
156:                 this.error = "Failed to save friends: " + error.message;
157:             } finally {
158:                 this.loading = false;
159:             }
160:         },
161:     }));
162: 
163:     // Register the main app component with theme support
164:     Alpine.data("appState", () => ({
165:         person: {},
166:         username: "",
167:         password: "",
168:         loginError: "",
169:         loading: false,
170: 
171:         async init() {
172:             await this.checkStoredSession();
173:         },
174: 
175:         async checkStoredSession() {
176:             console.debug("[Session] Checking for stored session data");
177:             try {
178:                 const stored = StorageManager.getStoredAuthData();
179: 
180:                 if (stored?.profile) {
181:                     authManager.setTokens(stored.accessJwt, stored.refreshJwt);
182:                     this.person = stored.profile;
183:                     Alpine.store("person", stored.profile);
184:                     Alpine.store("state").setPerson(stored.profile);
185: 
186:                     // Initialize theme and update Alpine state
187:                     await themeManager.initialize();
188:                     const themeComponent = this.$store.theme;
189:                     if (themeComponent) {
190:                         themeComponent.themeClass =
191:                             themeManager.getThemeClasses();
192:                     }
193:                 }
194:             } catch (error) {
195:                 console.error(
196:                     "[Session] Error checking stored session:",
197:                     error,
198:                 );
199:                 StorageManager.clearAuthData();
200:             }
201:         },
202: 
203:         async loginUser() {
204:             if (!this.username || !this.password) {
205:                 this.loginError = "Please provide both username and password";
206:                 return;
207:             }
208: 
209:             this.loading = true;
210:             this.loginError = "";
211: 
212:             try {
213:                 const authData = await authManager.authenticate(
214:                     this.username.trim(),
215:                     this.password,
216:                 );
217: 
218:                 const profile = await profileManager.fetchProfile(
219:                     authData.handle,
220:                 );
221: 
222:                 // Update all relevant stores/states
223:                 this.person = profile;
224:                 Alpine.store("person", profile);
225:                 Alpine.store("state").setPerson(profile);
226: 
227:                 // Initialize theme immediately after login and update Alpine state
228:                 await themeManager.initialize();
229: 
230:                 // Update the theme component's state
231:                 const themeComponent = this.$store.theme;
232:                 if (themeComponent) {
233:                     themeComponent.themeClass = themeManager.getThemeClasses();
234:                 }
235: 
236:                 StorageManager.saveAuthData(authData, profile);
237: 
238:                 // Clear sensitive data
239:                 this.password = "";
240:                 this.username = "";
241:             } catch (error) {
242:                 console.error("[Login] Error during login process:", error);
243:                 this.loginError = error.message || "Login failed";
244:                 this.password = "";
245:             } finally {
246:                 this.loading = false;
247:             }
248:         },
249: 
250:         async logout() {
251:             try {
252:                 await authManager.clearTokens();
253:                 await StorageManager.clearAuthData();
254: 
255:                 this.person = {};
256:                 this.username = "";
257:                 this.password = "";
258:                 this.loginError = "";
259: 
260:                 Alpine.store("person", {});
261:                 Alpine.store("state").setPerson({});
262: 
263:                 // Reset theme to default and update Alpine state
264:                 const defaultTheme = themeManager.colorThemes[0];
265:                 document.body.className = defaultTheme;
266:                 themeManager.currentTheme = defaultTheme;
267:                 const themeComponent = this.$store.theme;
268:                 if (themeComponent) {
269:                     themeComponent.themeClass = themeManager.getThemeClasses();
270:                 }
271:             } catch (error) {
272:                 console.error("[Logout] Error during logout:", error);
273:                 throw new Error("Logout failed: " + error.message);
274:             }
275:         },
276:     }));
277: 
278:     // Register the posts component
279:     Alpine.data("posts", () => ({
280:         blogs: [],
281:         loading: true,
282:         error: null,
283:         lastHandle: null, // Track last processed handle to prevent duplicate loads
284: 
285:         init() {
286:             console.debug("[Posts Component] Initializing posts component");
287:             this.loadInitialPosts();
288:             this.setupWatcher();
289:         },
290: 
291:         async loadInitialPosts() {
292:             // Check for person data on init
293:             console.debug("[Posts Component] Checking for initial person data");
294:             const person = Alpine.store("state").person;
295:             if (person?.bsky_handle) {
296:                 console.debug(
297:                     "[Posts Component] Found initial person data, loading posts",
298:                 );
299:                 await this.loadPostsForHandle(person.bsky_handle);
300:             }
301:         },
302: 
303:         setupWatcher() {
304:             console.debug("[Posts Component] Setting up person store watcher");
305:             this.$watch("$store.person", async (person) => {
306:                 if (!person) {
307:                     console.debug(
308:                         "[Posts Component] Person data cleared, resetting state",
309:                     );
310:                     this.resetState();
311:                     return;
312:                 }
313: 
314:                 if (!person.bsky_handle) {
315:                     console.warn(
316:                         "[Posts Component] Person missing bsky_handle",
317:                     );
318:                     this.error =
319:                         "Invalid user profile - missing Bluesky handle";
320:                     return;
321:                 }
322: 
323:                 if (person.bsky_handle === this.lastHandle) {
324:                     console.debug(
325:                         "[Posts Component] Skipping duplicate load for handle:",
326:                         person.bsky_handle,
327:                     );
328:                     return;
329:                 }
330: 
331:                 await this.loadPostsForHandle(person.bsky_handle);
332:             });
333:         },
334: 
335:         async loadPostsForHandle(handle) {
336:             console.debug(
337:                 "[Posts Component] Loading posts for handle:",
338:                 handle,
339:             );
340:             this.loading = true;
341:             this.error = null;
342: 
343:             try {
344:                 const postManager = new PostManager();
345:                 const state = await postManager.loadPosts(handle);
346: 
347:                 console.debug("[Posts Component] Posts loaded:", {
348:                     postCount: state.blogs?.length || 0,
349:                     loading: state.loading,
350:                     error: state.error,
351:                 });
352: 
353:                 this.blogs = state.blogs || [];
354:                 this.loading = state.loading;
355:                 this.error = state.error;
356:                 this.lastHandle = handle;
357:             } catch (error) {
358:                 console.error("[Posts Component] Error loading posts:", error);
359:                 this.error = "Failed to load posts: " + error.message;
360:                 this.blogs = [];
361:             } finally {
362:                 this.loading = false;
363:             }
364:         },
365: 
366:         resetState() {
367:             this.blogs = [];
368:             this.loading = false;
369:             this.error = null;
370:             this.lastHandle = null;
371:         },
372:     }));
373: 
374:     // Register the theme store
375:     Alpine.store("theme", {
376:         themeClass: themeManager.getThemeClasses(),
377:     });
378: });
</file>

<file path="js/auth.js">
  1: // Authentication Manager Class
  2: class AuthManager {
  3:     constructor() {
  4:         this.accessToken = null;
  5:         this.refreshToken = null;
  6:         this.did = null;
  7:     }
  8: 
  9:     async authenticate(username, password) {
 10:         console.debug("[AuthManager] Starting authentication attempt", {
 11:             username,
 12:         });
 13: 
 14:         // Input validation
 15:         if (!username || !password) {
 16:             console.error("[AuthManager] Missing credentials");
 17:             throw new Error("Username and password are required");
 18:         }
 19: 
 20:         // Build request URL and validate
 21:         const url = `${CONFIG.API.BASE_URL}${CONFIG.API.ENDPOINTS.CREATE_SESSION}`;
 22:         if (!url) {
 23:             console.error("[AuthManager] Invalid API URL configuration");
 24:             throw new Error("Invalid API configuration");
 25:         }
 26: 
 27:         try {
 28:             console.debug("[AuthManager] Sending authentication request");
 29:             const response = await fetch(url, {
 30:                 method: "POST",
 31:                 headers: {
 32:                     "Content-Type": "application/json",
 33:                     Accept: "application/json",
 34:                 },
 35:                 body: JSON.stringify({
 36:                     identifier: username.trim(),
 37:                     password,
 38:                 }),
 39:             });
 40: 
 41:             console.debug("[AuthManager] Received response", {
 42:                 status: response.status,
 43:                 statusText: response.statusText,
 44:             });
 45: 
 46:             if (!response.ok) {
 47:                 const errorBody = await response.text();
 48:                 console.error("[AuthManager] Authentication failed", {
 49:                     status: response.status,
 50:                     statusText: response.statusText,
 51:                     body: errorBody,
 52:                 });
 53:                 throw new Error(
 54:                     `Authentication failed: ${response.status} ${response.statusText}`,
 55:                 );
 56:             }
 57: 
 58:             const authData = await response.json();
 59: 
 60:             // Validate response data
 61:             if (!authData?.accessJwt || !authData?.refreshJwt) {
 62:                 console.error("[AuthManager] Invalid auth response data", {
 63:                     authData,
 64:                 });
 65:                 throw new Error("Invalid authentication response");
 66:             }
 67: 
 68:             console.debug("[AuthManager] Setting tokens");
 69:             this.setTokens(authData.accessJwt, authData.refreshJwt);
 70: 
 71:             console.debug("[AuthManager] Authentication successful");
 72:             return authData;
 73:         } catch (error) {
 74:             console.error("[AuthManager] Authentication error:", error);
 75:             throw error;
 76:         }
 77:     }
 78: 
 79:     setTokens(accessToken, refreshToken) {
 80:         console.debug("[AuthManager] Setting authentication tokens");
 81: 
 82:         // Validate input tokens
 83:         if (!accessToken || typeof accessToken !== "string") {
 84:             console.error("[AuthManager] Invalid access token provided", {
 85:                 accessToken,
 86:             });
 87:             throw new Error("Invalid access token");
 88:         }
 89: 
 90:         if (!refreshToken || typeof refreshToken !== "string") {
 91:             console.error("[AuthManager] Invalid refresh token provided", {
 92:                 refreshToken,
 93:             });
 94:             throw new Error("Invalid refresh token");
 95:         }
 96: 
 97:         // Token format validation (basic JWT structure check)
 98:         const jwtRegex =
 99:             /^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*$/;
100:         if (!jwtRegex.test(accessToken)) {
101:             console.error(
102:                 "[AuthManager] Access token fails JWT format validation",
103:             );
104:             throw new Error("Invalid access token format");
105:         }
106: 
107:         if (!jwtRegex.test(refreshToken)) {
108:             console.error(
109:                 "[AuthManager] Refresh token fails JWT format validation",
110:             );
111:             throw new Error("Invalid refresh token format");
112:         }
113: 
114:         // Store tokens
115:         try {
116:             this.accessToken = accessToken.trim();
117:             this.refreshToken = refreshToken.trim();
118:             // Extract DID from JWT payload
119:             const payload = JSON.parse(atob(accessToken.split(".")[1]));
120:             this.did = payload.sub;
121: 
122:             console.debug("[AuthManager] Tokens and DID set successfully", {
123:                 accessTokenLength: this.accessToken.length,
124:                 refreshTokenLength: this.refreshToken.length,
125:                 did: this.did,
126:             });
127:         } catch (error) {
128:             console.error("[AuthManager] Error while setting tokens:", error);
129:             this.accessToken = null;
130:             this.refreshToken = null;
131:             throw error;
132:         }
133:     }
134: 
135:     async refreshSession() {
136:         console.debug("[AuthManager] Starting session refresh");
137: 
138:         // Validate refresh token exists
139:         if (!this.refreshToken) {
140:             console.debug(
141:                 "[AuthManager] No refresh token available, aborting refresh",
142:             );
143:             return false;
144:         }
145: 
146:         // Build and validate request URL
147:         const url = `${CONFIG.API.BASE_URL}${CONFIG.API.ENDPOINTS.REFRESH_SESSION}`;
148:         if (!url) {
149:             console.error("[AuthManager] Invalid refresh URL configuration");
150:             return false;
151:         }
152: 
153:         try {
154:             console.debug("[AuthManager] Sending refresh request");
155:             const response = await fetch(url, {
156:                 method: "POST",
157:                 headers: {
158:                     Authorization: `Bearer ${this.refreshToken}`,
159:                     Accept: "application/json",
160:                 },
161:             });
162: 
163:             console.debug("[AuthManager] Received refresh response", {
164:                 status: response.status,
165:                 statusText: response.statusText,
166:             });
167: 
168:             if (!response.ok) {
169:                 const errorBody = await response.text();
170:                 console.error("[AuthManager] Refresh failed", {
171:                     status: response.status,
172:                     statusText: response.statusText,
173:                     body: errorBody,
174:                 });
175:                 throw new Error(
176:                     `Refresh failed: ${response.status} ${response.statusText}`,
177:                 );
178:             }
179: 
180:             const refreshData = await response.json();
181: 
182:             // Validate response data
183:             if (!refreshData?.accessJwt || !refreshData?.refreshJwt) {
184:                 console.error("[AuthManager] Invalid refresh response data", {
185:                     refreshData,
186:                 });
187:                 throw new Error("Invalid refresh response");
188:             }
189: 
190:             console.debug("[AuthManager] Setting new tokens from refresh");
191:             this.setTokens(refreshData.accessJwt, refreshData.refreshJwt);
192: 
193:             console.debug("[AuthManager] Session refresh successful");
194:             return refreshData;
195:         } catch (error) {
196:             console.error("[AuthManager] Session refresh error:", error);
197:             this.clearTokens(); // Clear invalid tokens
198:             return false;
199:         }
200:     }
201: 
202:     getAuthHeaders(contentType = "application/json") {
203:         console.debug("[AuthManager] Generating auth headers");
204: 
205:         // Validate access token exists
206:         if (!this.accessToken) {
207:             console.warn("[AuthManager] No access token available for headers");
208:             throw new Error("No access token available");
209:         }
210: 
211:         // Validate token format
212:         const jwtRegex =
213:             /^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*$/;
214:         if (!jwtRegex.test(this.accessToken)) {
215:             console.error(
216:                 "[AuthManager] Access token fails JWT format validation",
217:             );
218:             throw new Error("Invalid access token format");
219:         }
220: 
221:         // Validate content type
222:         if (typeof contentType !== "string" || !contentType.trim()) {
223:             console.warn(
224:                 "[AuthManager] Invalid content type provided, using default",
225:             );
226:             contentType = "application/json";
227:         }
228: 
229:         const headers = {
230:             Authorization: `Bearer ${this.accessToken.trim()}`,
231:             "Content-Type": contentType.trim(),
232:             Accept: "application/json",
233:         };
234: 
235:         console.debug("[AuthManager] Generated auth headers", {
236:             hasAuth: !!headers.Authorization,
237:             contentType: headers["Content-Type"],
238:         });
239: 
240:         return headers;
241:     }
242: 
243:     clearTokens() {
244:         console.debug("[AuthManager] Clearing authentication tokens");
245: 
246:         try {
247:             // Store original values for logging
248:             const hadAccessToken = !!this.accessToken;
249:             const hadRefreshToken = !!this.refreshToken;
250: 
251:             // Clear both tokens
252:             this.accessToken = null;
253:             this.refreshToken = null;
254: 
255:             // Verify tokens were cleared successfully
256:             if (this.accessToken !== null || this.refreshToken !== null) {
257:                 console.error(
258:                     "[AuthManager] Failed to clear tokens completely",
259:                 );
260:                 throw new Error("Token clearing failed");
261:             }
262: 
263:             console.debug("[AuthManager] Tokens cleared successfully", {
264:                 previouslyHadAccess: hadAccessToken,
265:                 previouslyHadRefresh: hadRefreshToken,
266:                 currentAccessToken: this.accessToken,
267:                 currentRefreshToken: this.refreshToken,
268:             });
269: 
270:             return true;
271:         } catch (error) {
272:             console.error("[AuthManager] Error while clearing tokens:", error);
273:             // Attempt forceful clear one more time
274:             this.accessToken = null;
275:             this.refreshToken = null;
276:             this.did = null;
277:             throw error;
278:         }
279:     }
280: }
</file>

<file path="js/config.js">
 1: // Constants and Configuration
 2: const CONFIG = {
 3:     API: {
 4:         BASE_URL: "https://bsky.social/xrpc",
 5:         PUBLIC_URL: "https://public.api.bsky.app/xrpc",
 6:         ENDPOINTS: {
 7:             CREATE_SESSION: "/com.atproto.server.createSession",
 8:             REFRESH_SESSION: "/com.atproto.server.refreshSession",
 9:             GET_PROFILE: "/app.bsky.actor.getProfile",
10:             GET_AUTHOR_FEED: "/app.bsky.feed.getAuthorFeed",
11:         },
12:     },
13:     STORAGE_KEYS: {
14:         AUTH: "bluesky_auth",
15:         THEME: "top8_theme",
16:     },
17:     THEME: {
18:         RECORD_TYPE: "app.top8.theme",
19:         RECORD_KEY: "self",
20:     },
21:     TOP8: {
22:         RECORD_TYPE: "app.bsky.graph.list", // Using the standard list type
23:         RECORD_KEY: "top8friends",
24:         LIST_PURPOSE: "app.bsky.graph.top8",
25:         MAX_FRIENDS: 8,
26:         CACHE_DURATION: 5 * 60 * 1000, // 5 minutes in milliseconds
27:     },
28: };
</file>

<file path="js/main.js">
 1: // Main App Class
 2: class Top8App {
 3:     constructor() {
 4:         this.authManager = new AuthManager();
 5:         this.profileManager = new ProfileManager(this.authManager);
 6:         this.themeManager = new ThemeManager();
 7:     }
 8: 
 9:     async initialize() {
10:         await this.themeManager.initialize();
11:         await this.restoreSession();
12:         this.setupEventListeners();
13:     }
14: 
15:     async restoreSession() {
16:         const storedAuth = StorageManager.getStoredAuthData();
17:         if (storedAuth) {
18:             this.authManager.setTokens(
19:                 storedAuth.accessJwt,
20:                 storedAuth.refreshJwt,
21:             );
22:             this.profileManager.profile = storedAuth.profile;
23:             return true;
24:         }
25:         return false;
26:     }
27: 
28:     setupEventListeners() {
29:         document.addEventListener("DOMContentLoaded", () => {
30:             this.bindToAlpine();
31:         });
32:     }
33: 
34:     bindToAlpine() {
35:         window.Alpine.data("top8App", () => ({
36:             person: this.profileManager.profile,
37:             themeClass: this.themeManager.getThemeClasses(),
38: 
39:             async loginUser(username, password) {
40:                 try {
41:                     const authData = await this.authManager.authenticate(
42:                         username,
43:                         password,
44:                     );
45:                     const profileData = await this.profileManager.fetchProfile(
46:                         authData.handle,
47:                     );
48:                     StorageManager.saveAuthData(authData, profileData);
49:                     this.person = profileData;
50:                     return true;
51:                 } catch (error) {
52:                     console.error("Login failed:", error);
53:                     return false;
54:                 }
55:             },
56: 
57:             logout() {
58:                 this.authManager.clearTokens();
59:                 StorageManager.clearAuthData();
60:                 this.profileManager.profile = null;
61:                 this.person = null;
62:             },
63: 
64:             async changeTheme(themeName) {
65:                 this.themeClass = await this.themeManager.setTheme(themeName);
66:             },
67:         }));
68:     }
69: }
70: 
71: // Initialize the application
72: const app = new Top8App();
73: app.initialize();
</file>

<file path="js/pds.js">
  1: class PDSRecordManager {
  2:     constructor(authManager) {
  3:         if (!authManager) {
  4:             throw new Error("[PDSRecordManager] AuthManager is required");
  5:         }
  6:         this.authManager = authManager;
  7:         this.baseUrl = CONFIG.API.BASE_URL;
  8:     }
  9: 
 10:     // Helper method to handle auth headers with refresh
 11:     async getAuthHeadersWithRefresh() {
 12:         try {
 13:             // First try getting regular headers
 14:             const headers = this.authManager.getAuthHeaders();
 15:             return headers;
 16:         } catch (error) {
 17:             console.debug(
 18:                 "[PDSRecordManager] Initial auth headers failed, attempting refresh",
 19:             );
 20: 
 21:             // Attempt to refresh the session
 22:             const refreshResult = await this.authManager.refreshSession();
 23:             if (!refreshResult) {
 24:                 throw new Error("Failed to refresh authentication");
 25:             }
 26: 
 27:             // Try getting headers again after refresh
 28:             return this.authManager.getAuthHeaders();
 29:         }
 30:     }
 31: 
 32:     async putRecord(collection, rkey, record) {
 33:         console.debug("[PDSRecordManager] Attempting to put record", {
 34:             collection,
 35:             rkey,
 36:             recordSize: JSON.stringify(record).length,
 37:         });
 38: 
 39:         // Validate params first
 40:         if (!collection || !rkey || !record) {
 41:             throw new Error("Missing required parameters");
 42:         }
 43: 
 44:         try {
 45:             // Get auth headers with potential refresh
 46:             const headers = await this.getAuthHeadersWithRefresh();
 47: 
 48:             if (!headers?.Authorization) {
 49:                 throw new Error("No valid authorization header");
 50:             }
 51: 
 52:             // Prepare request body
 53:             const requestBody = {
 54:                 repo: this.authManager.did,
 55:                 collection,
 56:                 rkey,
 57:                 record: {
 58:                     ...record,
 59:                     $type: collection,
 60:                     createdAt: new Date().toISOString(),
 61:                 },
 62:             };
 63: 
 64:             const response = await fetch(
 65:                 `${this.baseUrl}/com.atproto.repo.putRecord`,
 66:                 {
 67:                     method: "POST",
 68:                     headers: headers,
 69:                     body: JSON.stringify(requestBody),
 70:                 },
 71:             );
 72: 
 73:             if (!response.ok) {
 74:                 const errorText = await response.text();
 75:                 throw new Error(
 76:                     `HTTP error! status: ${response.status} ${errorText}`,
 77:                 );
 78:             }
 79: 
 80:             return await response.json();
 81:         } catch (error) {
 82:             console.error("[PDSRecordManager] Put record error:", error);
 83:             throw error;
 84:         }
 85:     }
 86: 
 87:     async getRecord(collection, rkey) {
 88:         console.debug("[PDSRecordManager] Attempting to get record", {
 89:             collection,
 90:             rkey,
 91:         });
 92: 
 93:         if (!collection || !rkey) {
 94:             throw new Error("Missing required parameters");
 95:         }
 96: 
 97:         try {
 98:             // Get auth headers with potential refresh
 99:             const headers = await this.getAuthHeadersWithRefresh();
100: 
101:             if (!headers?.Authorization) {
102:                 throw new Error("No valid authorization header");
103:             }
104: 
105:             const url = new URL(`${this.baseUrl}/com.atproto.repo.getRecord`);
106:             url.searchParams.append("repo", this.authManager.did);
107:             url.searchParams.append("collection", collection);
108:             url.searchParams.append("rkey", rkey);
109: 
110:             const response = await fetch(url, {
111:                 headers: headers,
112:             });
113: 
114:             if (response.status === 404) {
115:                 return null;
116:             }
117: 
118:             if (!response.ok) {
119:                 const errorText = await response.text();
120:                 throw new Error(
121:                     `HTTP error! status: ${response.status} ${errorText}`,
122:                 );
123:             }
124: 
125:             const data = await response.json();
126:             return data.value;
127:         } catch (error) {
128:             console.error("[PDSRecordManager] Get record error:", error);
129:             throw error;
130:         }
131:     }
132: }
</file>

<file path="js/posts.js">
  1: // Post Manager Class
  2: class PostManager {
  3:     constructor() {
  4:         // Initialize empty state
  5:         this.state = {
  6:             blogs: [],
  7:             loading: true,
  8:             error: null,
  9:         };
 10:     }
 11: 
 12:     // Format posts data
 13:     formatPosts(feed, handle) {
 14:         const logPrefix = '[PostManager::formatPosts]';
 15:         console.debug(`${logPrefix} Starting format, input:`, {
 16:             feedLength: feed?.length || 0,
 17:             handle,
 18:             feedType: typeof feed
 19:         });
 20: 
 21:         // Validate inputs
 22:         if (!handle || typeof handle !== 'string') {
 23:             console.warn(`${logPrefix} Invalid handle provided:`, handle);
 24:             return [];
 25:         }
 26: 
 27:         if (!Array.isArray(feed)) {
 28:             console.warn(`${logPrefix} Invalid feed provided:`, feed);
 29:             return [];
 30:         }
 31: 
 32:         try {
 33:             console.debug(`${logPrefix} Starting post filtering`);
 34:             const filteredPosts = feed.filter((item) => {
 35:                 // Deep validation of item structure
 36:                 if (!item?.post?.record || !item.post?.author) {
 37:                     console.warn(`${logPrefix} Invalid post structure:`, {
 38:                         hasPost: !!item?.post,
 39:                         hasRecord: !!item?.post?.record,
 40:                         hasAuthor: !!item?.post?.author
 41:                     });
 42:                     return false;
 43:                 }
 44: 
 45:                 const post = item.post;
 46:                 console.debug(`${logPrefix} Processing post:`, {
 47:                     uri: post.uri,
 48:                     author: post.author.handle,
 49:                     isReply: !!post.record.reply,
 50:                     isRepost: !!post.record.repost
 51:                 });
 52: 
 53:                 // Enhanced filtering logic
 54:                 const isOriginalPost = (
 55:                     !post.record.reply &&
 56:                     !post.record.repost &&
 57:                     post.author.handle === handle &&
 58:                     post.record.text?.trim().length > 0 // Ensure non-empty posts
 59:                 );
 60: 
 61:                 console.debug(`${logPrefix} Post filtering result:`, {
 62:                     uri: post.uri,
 63:                     isOriginalPost,
 64:                     matchesHandle: post.author.handle === handle
 65:                 });
 66: 
 67:                 return isOriginalPost;
 68:             });
 69: 
 70:             console.debug(`${logPrefix} Filtered ${feed.length} -> ${filteredPosts.length} posts`);
 71: 
 72:             // Use slice instead of splice to avoid mutating original array
 73:             const limitedPosts = filteredPosts.slice(0, 12);
 74:             console.debug(`${logPrefix} Limited to ${limitedPosts.length} posts`);
 75: 
 76:             return limitedPosts.map((item, index) => {
 77:                 const post = item.post;
 78:                 const author = post.author || {};
 79: 
 80:                 try {
 81:                     const formattedPost = {
 82:                         text: post.record.text?.trim() || "",
 83:                         createdAt: this.validateDate(post.record.createdAt),
 84:                         author: {
 85:                             name: this.sanitizeString(author.displayName) || author.handle || "Unknown",
 86:                             handle: author.handle || "unknown",
 87:                             url: author.handle
 88:                                 ? `https://bsky.app/profile/${encodeURIComponent(author.handle)}`
 89:                                 : "#",
 90:                         },
 91:                         uri: post.uri || "",
 92:                         id: post.cid || `temp-${index}` // Added unique ID
 93:                     };
 94: 
 95:                     console.debug(`${logPrefix} Formatted post ${index + 1}/${limitedPosts.length}:`, formattedPost);
 96:                     return formattedPost;
 97:                 } catch (formatError) {
 98:                     console.error(`${logPrefix} Error formatting individual post:`, formatError);
 99:                     return null;
100:                 }
101:             }).filter(Boolean); // Remove any null entries from failed formatting
102: 
103:         } catch (error) {
104:             console.error(`${logPrefix} Fatal error formatting posts:`, error);
105:             return [];
106:         }
107:     }
108: 
109:     // Helper method to validate dates
110:     validateDate(dateString) {
111:         try {
112:             const date = new Date(dateString);
113:             return date.toISOString();
114:         } catch {
115:             return new Date().toISOString();
116:         }
117:     }
118: 
119:     // Helper method to sanitize strings
120:     sanitizeString(str) {
121:         if (!str) return '';
122:         return String(str).trim().slice(0, 500); // Reasonable length limit
123:     }
124: 
125:     // Fetch posts for a user
126:     async loadPosts(handle, limit = 64, retryAttempts = 3) {
127:         console.debug(
128:             "[PostManager] Loading posts for handle:",
129:             handle,
130:             "limit:",
131:             limit,
132:         );
133: 
134:         // Validate handle
135:         if (!handle || typeof handle !== "string") {
136:             console.warn("[PostManager] Invalid handle provided:", handle);
137:             this.state.loading = false;
138:             this.state.error = "Invalid handle";
139:             return this.state;
140:         }
141: 
142:         this.state.loading = true;
143:         this.state.error = null;
144:         this.state.blogs = [];
145: 
146:         let attempts = 0;
147:         while (attempts < retryAttempts) {
148:             try {
149:                 console.debug(
150:                     `[PostManager] Fetch attempt ${attempts + 1}/${retryAttempts}`,
151:                 );
152: 
153:                 const url = `${CONFIG.API.PUBLIC_URL}${CONFIG.API.ENDPOINTS.GET_AUTHOR_FEED}?actor=${encodeURIComponent(handle)}&limit=${limit}`;
154:                 console.debug("[PostManager] Fetching from URL:", url);
155: 
156:                 const response = await fetch(url, {
157:                     method: "GET",
158:                     headers: {
159:                         Accept: "application/json",
160:                     },
161:                     timeout: 5000,
162:                 });
163: 
164:                 console.debug(
165:                     "[PostManager] Response status:",
166:                     response.status,
167:                 );
168: 
169:                 if (!response.ok) {
170:                     throw new Error(`HTTP error! status: ${response.status}`);
171:                 }
172: 
173:                 const data = await response.json();
174:                 console.debug("[PostManager] Received data:", data);
175: 
176:                 if (!data || !Array.isArray(data.feed)) {
177:                     throw new Error("Invalid response format");
178:                 }
179: 
180:                 this.state.blogs = this.formatPosts(data.feed, handle);
181:                 console.debug(
182:                     "[PostManager] Successfully loaded posts, count:",
183:                     this.state.blogs.length,
184:                 );
185:                 break;
186:             } catch (err) {
187:                 attempts++;
188:                 console.error(
189:                     `[PostManager] Error loading posts (attempt ${attempts}/${retryAttempts}):`,
190:                     err,
191:                 );
192: 
193:                 if (attempts === retryAttempts) {
194:                     this.state.error = `Failed to load posts: ${err.message}`;
195:                     this.state.blogs = [];
196:                 } else {
197:                     // Wait before retry with exponential backoff
198:                     await new Promise((resolve) =>
199:                         setTimeout(resolve, Math.pow(2, attempts) * 1000),
200:                     );
201:                     continue;
202:                 }
203:             }
204:         }
205: 
206:         this.state.loading = false;
207:         console.debug(
208:             "[PostManager] Final state:",
209:             JSON.stringify(this.state, null, 2),
210:         );
211:         return this.state;
212:     }
213: }
</file>

<file path="js/profile.js">
  1: class ProfileManager {
  2:     constructor(authManager) {
  3:         this.authManager = authManager;
  4:         this.profile = null;
  5:     }
  6: 
  7:     async fetchProfile(handle) {
  8:         console.debug(
  9:             `[ProfileManager] Fetching profile for handle: ${handle}`,
 10:         );
 11: 
 12:         if (!handle) {
 13:             console.error("[ProfileManager] No handle provided");
 14:             throw new Error("Handle is required");
 15:         }
 16: 
 17:         try {
 18:             const url = `${CONFIG.API.BASE_URL}${CONFIG.API.ENDPOINTS.GET_PROFILE}?actor=${encodeURIComponent(handle)}`;
 19:             console.debug(`[ProfileManager] Making request to: ${url}`);
 20: 
 21:             const headers = this.authManager.getAuthHeaders();
 22:             console.debug("[ProfileManager] Request headers:", headers);
 23: 
 24:             const response = await fetch(url, { headers });
 25:             console.debug(
 26:                 `[ProfileManager] Response status: ${response.status}`,
 27:             );
 28: 
 29:             if (!response.ok) {
 30:                 const errorText = await response.text();
 31:                 console.error(
 32:                     `[ProfileManager] Failed to fetch profile. Status: ${response.status}, Error: ${errorText}`,
 33:                 );
 34:                 throw new Error(
 35:                     `Failed to fetch profile: ${response.status} ${response.statusText}`,
 36:                 );
 37:             }
 38: 
 39:             const data = await response.json();
 40:             console.debug("[ProfileManager] Raw profile data:", data);
 41: 
 42:             if (!data || typeof data !== "object") {
 43:                 console.error("[ProfileManager] Invalid profile data received");
 44:                 throw new Error("Invalid profile data received");
 45:             }
 46: 
 47:             this.profile = this.formatProfileData(data);
 48:             console.debug("[ProfileManager] Formatted profile:", this.profile);
 49: 
 50:             return this.profile;
 51:         } catch (error) {
 52:             console.error("[ProfileManager] Profile fetch error:", {
 53:                 handle,
 54:                 error: error.message,
 55:                 stack: error.stack,
 56:             });
 57:             throw new Error(
 58:                 `Failed to fetch profile for ${handle}: ${error.message}`,
 59:             );
 60:         }
 61:     }
 62: 
 63:     formatProfileData(data) {
 64:         console.debug("[ProfileManager] Formatting profile data:", data);
 65: 
 66:         // Validate input data
 67:         if (!data || typeof data !== "object") {
 68:             console.error("[ProfileManager] Invalid data object received");
 69:             throw new Error("Invalid profile data object");
 70:         }
 71: 
 72:         // Validate required fields
 73:         if (!data.handle) {
 74:             console.error("[ProfileManager] Missing required handle field");
 75:             throw new Error("Profile data missing required handle field");
 76:         }
 77: 
 78:         if (!data.did) {
 79:             console.error("[ProfileManager] Missing required DID field");
 80:             throw new Error("Profile data missing required DID field");
 81:         }
 82: 
 83:         // Safely access optional fields
 84:         const displayName = data.displayName?.trim() || null;
 85:         const handle = data.handle?.trim();
 86:         const avatar = data.avatar || null;
 87:         const description = data.description?.trim() || null;
 88: 
 89:         console.debug("[ProfileManager] Extracted profile fields:", {
 90:             displayName,
 91:             handle,
 92:             avatar,
 93:             description,
 94:         });
 95: 
 96:         const formattedProfile = {
 97:             name: displayName || handle, // Fallback to handle if no display name
 98:             bsky_handle: handle,
 99:             bsky_url: `https://bsky.app/profile/${encodeURIComponent(handle)}`,
100:             bsky_did: data.did,
101:             avatar: avatar,
102:             note: description,
103:             raw: data, // Store raw data for debugging
104:         };
105: 
106:         console.debug("[ProfileManager] Formatted profile:", formattedProfile);
107:         return formattedProfile;
108:     }
109: 
110:     // async fetchPosts(handle, limit = 12) {
111:     //     try {
112:     //         const response = await fetch(
113:     //             `${CONFIG.API.PUBLIC_URL}${CONFIG.API.ENDPOINTS.GET_AUTHOR_FEED}?actor=${handle}&limit=${limit}`,
114:     //             { headers: this.authManager.getAuthHeaders() },
115:     //         );
116: 
117:     //         if (!response.ok) throw new Error("Failed to fetch posts");
118: 
119:     //         const data = await response.json();
120:     //         return this.formatPosts(data.feed);
121:     //     } catch (error) {
122:     //         console.error("Posts fetch error:", error);
123:     //         throw error;
124:     //     }
125:     // }
126: 
127:     // formatPosts(feed) {
128:     //     return feed
129:     //         .filter(
130:     //             (item) => !item.post.record.reply && !item.post.record.repost,
131:     //         )
132:     //         .map((item) => ({
133:     //             text: item.post.record.text,
134:     //             createdAt: new Date(
135:     //                 item.post.record.createdAt,
136:     //             ).toLocaleString(),
137:     //             author: {
138:     //                 name:
139:     //                     item.post.author.displayName || item.post.author.handle,
140:     //                 handle: item.post.author.handle,
141:     //                 avatar: item.post.author.avatar,
142:     //             },
143:     //             // Add engagement metrics
144:     //             replyCount: item.post.replyCount || 0,
145:     //             repostCount: item.post.repostCount || 0,
146:     //             likeCount: item.post.likeCount || 0,
147:     //             // Add embed handling if present
148:     //             embed: this.formatEmbed(item.post.embed),
149:     //             // Add original URI for linking
150:     //             uri: item.post.uri,
151:     //             // Add cid for unique identification
152:     //             cid: item.post.cid,
153:     //         }));
154:     // }
155: 
156:     // formatEmbed(embed) {
157:     //     if (!embed) return null;
158: 
159:     //     // Handle images
160:     //     if (embed.images) {
161:     //         return {
162:     //             type: "images",
163:     //             images: embed.images.map((img) => ({
164:     //                 url: img.thumb || img.fullsize,
165:     //                 alt: img.alt,
166:     //             })),
167:     //         };
168:     //     }
169: 
170:     //     // Handle external links
171:     //     if (embed.external) {
172:     //         return {
173:     //             type: "external",
174:     //             url: embed.external.uri,
175:     //             title: embed.external.title,
176:     //             description: embed.external.description,
177:     //             thumb: embed.external.thumb,
178:     //         };
179:     //     }
180: 
181:     //     // Handle record embeds (quotes, etc)
182:     //     if (embed.record) {
183:     //         return {
184:     //             type: "record",
185:     //             record: {
186:     //                 text: embed.record.value.text,
187:     //                 author: embed.record.author,
188:     //             },
189:     //         };
190:     //     }
191: 
192:     //     return null;
193:     // }
194: }
</file>

<file path="js/storage.js">
  1: class StorageManager {
  2:     static saveAuthData(authData, profileData) {
  3:         console.debug("[StorageManager] Attempting to save auth data...", {
  4:             hasAuthData: !!authData,
  5:             hasProfileData: !!profileData,
  6:         });
  7: 
  8:         // Validate required inputs
  9:         if (!authData || !profileData) {
 10:             console.error(
 11:                 "[StorageManager] Missing required auth or profile data",
 12:             );
 13:             throw new Error("Missing required auth or profile data");
 14:         }
 15: 
 16:         // Validate required auth properties
 17:         const requiredAuthProps = ["accessJwt", "refreshJwt"];
 18:         const missingAuthProps = requiredAuthProps.filter(
 19:             (prop) => !authData[prop],
 20:         );
 21:         if (missingAuthProps.length) {
 22:             console.error(
 23:                 "[StorageManager] Missing required auth properties:",
 24:                 missingAuthProps,
 25:             );
 26:             throw new Error(
 27:                 `Missing required auth properties: ${missingAuthProps.join(", ")}`,
 28:             );
 29:         }
 30: 
 31:         try {
 32:             // Prepare storage data
 33:             const storageData = {
 34:                 accessJwt: authData.accessJwt,
 35:                 refreshJwt: authData.refreshJwt,
 36:                 handle: profileData.bsky_handle,
 37:                 profile: profileData,
 38:                 lastUpdated: new Date().toISOString(),
 39:             };
 40: 
 41:             console.debug("[StorageManager] Saving auth data to storage...", {
 42:                 handle: storageData.handle,
 43:                 lastUpdated: storageData.lastUpdated,
 44:             });
 45: 
 46:             // Attempt to store data
 47:             localStorage.setItem(
 48:                 CONFIG.STORAGE_KEYS.AUTH,
 49:                 JSON.stringify(storageData),
 50:             );
 51: 
 52:             console.debug("[StorageManager] Auth data saved successfully");
 53:         } catch (error) {
 54:             console.error("[StorageManager] Failed to save auth data:", error);
 55:             throw new Error("Failed to save authentication data to storage");
 56:         }
 57:     }
 58: 
 59:     static getStoredAuthData() {
 60:         console.debug(
 61:             "[StorageManager] Attempting to retrieve stored auth data...",
 62:         );
 63: 
 64:         try {
 65:             // Attempt to get data from storage
 66:             const rawData = localStorage.getItem(CONFIG.STORAGE_KEYS.AUTH);
 67: 
 68:             console.debug("[StorageManager] Raw auth data retrieved:", {
 69:                 exists: !!rawData,
 70:             });
 71: 
 72:             if (!rawData) {
 73:                 console.debug("[StorageManager] No stored auth data found");
 74:                 return null;
 75:             }
 76: 
 77:             // Attempt to parse the data
 78:             const parsedData = JSON.parse(rawData);
 79: 
 80:             // Validate required fields
 81:             const requiredFields = [
 82:                 "accessJwt",
 83:                 "refreshJwt",
 84:                 "handle",
 85:                 "profile",
 86:                 "lastUpdated",
 87:             ];
 88:             const missingFields = requiredFields.filter(
 89:                 (field) => !parsedData[field],
 90:             );
 91: 
 92:             if (missingFields.length) {
 93:                 console.warn(
 94:                     "[StorageManager] Stored auth data is missing required fields:",
 95:                     missingFields,
 96:                 );
 97:                 return null;
 98:             }
 99: 
100:             console.debug(
101:                 "[StorageManager] Successfully retrieved and validated auth data",
102:                 {
103:                     handle: parsedData.handle,
104:                     lastUpdated: parsedData.lastUpdated,
105:                 },
106:             );
107: 
108:             return parsedData;
109:         } catch (error) {
110:             console.error(
111:                 "[StorageManager] Error retrieving stored auth data:",
112:                 error,
113:             );
114:             return null;
115:         }
116:     }
117: 
118:     static clearAuthData() {
119:         console.debug("[StorageManager] Attempting to clear auth data...");
120: 
121:         try {
122:             // Check if auth data exists before clearing
123:             const existingData = localStorage.getItem(CONFIG.STORAGE_KEYS.AUTH);
124: 
125:             console.debug("[StorageManager] Current auth data state:", {
126:                 exists: !!existingData,
127:                 storageKey: CONFIG.STORAGE_KEYS.AUTH,
128:             });
129: 
130:             // Attempt to remove the data
131:             localStorage.removeItem(CONFIG.STORAGE_KEYS.AUTH);
132: 
133:             // Verify removal was successful
134:             const remainingData = localStorage.getItem(
135:                 CONFIG.STORAGE_KEYS.AUTH,
136:             );
137:             if (remainingData) {
138:                 console.error(
139:                     "[StorageManager] Failed to clear auth data - data still exists",
140:                 );
141:                 throw new Error(
142:                     "Failed to clear authentication data from storage",
143:                 );
144:             }
145: 
146:             console.debug("[StorageManager] Auth data cleared successfully");
147:         } catch (error) {
148:             console.error("[StorageManager] Error clearing auth data:", error);
149:             throw new Error("Failed to clear authentication data from storage");
150:         }
151:     }
152: }
</file>

<file path="js/theme.js">
  1: class ThemeManager {
  2:     constructor() {
  3:         this.colorThemes = [
  4:             "pink",
  5:             "dark-blue",
  6:             "almond",
  7:             "vampire",
  8:             "toxic",
  9:             "shoes",
 10:             "angels",
 11:             "night",
 12:             "pastel",
 13:         ];
 14:         this.currentTheme = null;
 15:     }
 16: 
 17:     initialize() {
 18:         console.log("[ThemeManager] Initializing theme manager...");
 19: 
 20:         let storedTheme;
 21:         try {
 22:             // storedTheme = localStorage.getItem(CONFIG.STORAGE_KEYS.THEME);
 23:             console.log("[ThemeManager] Retrieved stored theme:", storedTheme);
 24:         } catch (err) {
 25:             console.error("[ThemeManager] Error accessing localStorage:", err);
 26:             return;
 27:         }
 28: 
 29:         if (!storedTheme) {
 30:             console.log("[ThemeManager] No stored theme found");
 31:             return;
 32:         }
 33: 
 34:         if (!this.colorThemes.includes(storedTheme)) {
 35:             console.warn("[ThemeManager] Invalid stored theme:", storedTheme);
 36:             console.log("[ThemeManager] Available themes:", this.colorThemes);
 37:             return;
 38:         }
 39: 
 40:         console.log("[ThemeManager] Setting valid stored theme:", storedTheme);
 41:         try {
 42:             const result = this.setTheme(storedTheme);
 43:             console.log("[ThemeManager] Theme set successfully:", result);
 44:         } catch (err) {
 45:             console.error("[ThemeManager] Error setting theme:", err);
 46:         }
 47:     }
 48: 
 49:     setTheme(themeName) {
 50:         console.log("[ThemeManager] Attempting to set theme:", themeName);
 51: 
 52:         if (!themeName || typeof themeName !== "string") {
 53:             console.error("[ThemeManager] Invalid theme parameter type");
 54:             return this.getThemeClasses();
 55:         }
 56: 
 57:         const normalizedTheme = themeName.trim().toLowerCase();
 58: 
 59:         if (!this.colorThemes.includes(normalizedTheme)) {
 60:             console.warn("[ThemeManager] Invalid theme name:", normalizedTheme);
 61:             console.log("[ThemeManager] Available themes:", this.colorThemes);
 62:             return this.getThemeClasses();
 63:         }
 64: 
 65:         try {
 66:             console.log(
 67:                 "[ThemeManager] Updating current theme to:",
 68:                 normalizedTheme,
 69:             );
 70:             this.currentTheme = normalizedTheme;
 71: 
 72:             console.log("[ThemeManager] Saving theme to localStorage");
 73:             // localStorage.setItem(CONFIG.STORAGE_KEYS.THEME, normalizedTheme);
 74: 
 75:             // Force body class update
 76:             document.body.className = normalizedTheme;
 77: 
 78:             const updatedClasses = this.getThemeClasses();
 79:             console.log(
 80:                 "[ThemeManager] Theme updated successfully, returning classes:",
 81:                 updatedClasses,
 82:             );
 83:             return updatedClasses;
 84:         } catch (error) {
 85:             console.error("[ThemeManager] Error setting theme:", error);
 86:             this.currentTheme = null;
 87:             return this.getThemeClasses();
 88:         }
 89:     }
 90: 
 91:     getThemeClasses() {
 92:         console.log("[ThemeManager] Getting theme classes...");
 93: 
 94:         if (!Array.isArray(this.colorThemes)) {
 95:             console.error("[ThemeManager] colorThemes is not an array");
 96:             return {};
 97:         }
 98: 
 99:         try {
100:             const themeClasses = this.colorThemes.reduce((acc, theme) => {
101:                 if (typeof theme !== "string") {
102:                     console.warn(
103:                         "[ThemeManager] Invalid theme type:",
104:                         typeof theme,
105:                     );
106:                     return acc;
107:                 }
108: 
109:                 const isActive = theme === this.currentTheme;
110:                 console.log(
111:                     `[ThemeManager] Processing theme '${theme}', active: ${isActive}`,
112:                 );
113: 
114:                 return {
115:                     ...acc,
116:                     [theme]: isActive,
117:                 };
118:             }, {});
119: 
120:             console.log(
121:                 "[ThemeManager] Generated theme classes:",
122:                 themeClasses,
123:             );
124:             return themeClasses;
125:         } catch (error) {
126:             console.error(
127:                 "[ThemeManager] Error generating theme classes:",
128:                 error,
129:             );
130:             return {};
131:         }
132:     }
133: 
134:     getColorChoiceClass(themeName) {
135:         console.log(
136:             "[ThemeManager] Getting color choice class for theme:",
137:             themeName,
138:         );
139: 
140:         if (!themeName || typeof themeName !== "string") {
141:             console.error(
142:                 "[ThemeManager] Invalid theme name parameter:",
143:                 themeName,
144:             );
145:             return { "color-choice": true };
146:         }
147: 
148:         const normalizedTheme = themeName.trim().toLowerCase();
149: 
150:         if (!this.colorThemes.includes(normalizedTheme)) {
151:             console.warn("[ThemeManager] Invalid theme name:", normalizedTheme);
152:             console.log("[ThemeManager] Available themes:", this.colorThemes);
153:             return { "color-choice": true };
154:         }
155: 
156:         try {
157:             const classes = {
158:                 "color-choice": true,
159:                 [normalizedTheme]: true,
160:             };
161:             console.log(
162:                 "[ThemeManager] Generated color choice classes:",
163:                 classes,
164:             );
165:             return classes;
166:         } catch (error) {
167:             console.error(
168:                 "[ThemeManager] Error generating color choice classes:",
169:                 error,
170:             );
171:             return { "color-choice": true };
172:         }
173:     }
174: }
</file>

<file path="js/themePDS.js">
  1: class PDSThemeManager {
  2:     constructor(authManager) {
  3:         if (!authManager) {
  4:             throw new Error("[PDSThemeManager] AuthManager is required");
  5:         }
  6:         this.pds = new PDSRecordManager(authManager);
  7:         this.colorThemes = [
  8:             "pink",
  9:             "dark-blue",
 10:             "almond",
 11:             "vampire",
 12:             "toxic",
 13:             "shoes",
 14:             "angels",
 15:             "night",
 16:             "pastel",
 17:         ];
 18:         this.currentTheme = null;
 19:     }
 20: 
 21:     async initialize() {
 22:         console.debug("[PDSThemeManager] Starting initialization...");
 23: 
 24:         try {
 25:             // Verify configuration
 26:             if (!CONFIG?.THEME?.RECORD_TYPE || !CONFIG?.THEME?.RECORD_KEY) {
 27:                 throw new Error("Theme configuration missing required values");
 28:             }
 29: 
 30:             // Attempt to fetch theme from PDS
 31:             console.debug("[PDSThemeManager] Fetching theme from PDS...");
 32:             const record = await this.pds.getRecord(
 33:                 CONFIG.THEME.RECORD_TYPE,
 34:                 CONFIG.THEME.RECORD_KEY,
 35:             );
 36: 
 37:             console.debug(
 38:                 "[PDSThemeManager] Retrieved PDS theme record:",
 39:                 record,
 40:             );
 41: 
 42:             if (!record) {
 43:                 console.debug(
 44:                     "[PDSThemeManager] No theme record found in PDS, creating default",
 45:                 );
 46:                 // Create default theme record
 47:                 await this.setTheme(this.colorThemes[0]);
 48:                 return;
 49:             }
 50: 
 51:             // Validate theme value
 52:             if (!record.theme || !this.colorThemes.includes(record.theme)) {
 53:                 console.warn(
 54:                     "[PDSThemeManager] Invalid theme in PDS record:",
 55:                     record.theme,
 56:                 );
 57:                 await this.setTheme(this.colorThemes[0]);
 58:                 return;
 59:             }
 60: 
 61:             // Set the theme
 62:             console.debug(
 63:                 "[PDSThemeManager] Setting theme from PDS:",
 64:                 record.theme,
 65:             );
 66:             await this.setTheme(record.theme);
 67: 
 68:             console.debug("[PDSThemeManager] Theme initialization complete", {
 69:                 currentTheme: this.currentTheme,
 70:                 recordFound: !!record,
 71:                 themeValue: record?.theme,
 72:             });
 73:         } catch (error) {
 74:             console.error("[PDSThemeManager] Initialization error:", {
 75:                 error: error.message,
 76:                 stack: error.stack,
 77:             });
 78:             // Set default theme on error
 79:             this.setThemeLocally(this.colorThemes[0]);
 80:         }
 81:     }
 82: 
 83:     async setTheme(themeName) {
 84:         console.debug("[PDSThemeManager] Setting theme:", themeName);
 85: 
 86:         try {
 87:             if (!themeName || typeof themeName !== "string") {
 88:                 throw new Error("Invalid theme name");
 89:             }
 90: 
 91:             const normalizedTheme = themeName.trim().toLowerCase();
 92:             if (!this.colorThemes.includes(normalizedTheme)) {
 93:                 throw new Error(`Invalid theme: ${normalizedTheme}`);
 94:             }
 95: 
 96:             // Set theme locally first
 97:             this.setThemeLocally(normalizedTheme);
 98: 
 99:             // Prepare record for PDS
100:             const record = {
101:                 theme: normalizedTheme,
102:                 updatedAt: new Date().toISOString(),
103:                 $type: CONFIG.THEME.RECORD_TYPE,
104:             };
105: 
106:             // Save to PDS
107:             console.debug("[PDSThemeManager] Saving theme to PDS:", record);
108:             await this.pds.putRecord(
109:                 CONFIG.THEME.RECORD_TYPE,
110:                 CONFIG.THEME.RECORD_KEY,
111:                 record,
112:             );
113: 
114:             console.debug("[PDSThemeManager] Theme saved successfully");
115:             return this.getThemeClasses();
116:         } catch (error) {
117:             console.error("[PDSThemeManager] Error setting theme:", {
118:                 error: error.message,
119:                 themeName,
120:                 currentState: this.currentTheme,
121:             });
122:             throw error;
123:         }
124:     }
125: 
126:     setThemeLocally(themeName) {
127:         this.currentTheme = themeName;
128:         document.body.className = themeName;
129:     }
130: 
131:     getThemeClasses() {
132:         return this.colorThemes.reduce(
133:             (acc, theme) => ({
134:                 ...acc,
135:                 [theme]: theme === this.currentTheme,
136:             }),
137:             {},
138:         );
139:     }
140: 
141:     validateTheme(themeName) {
142:         return this.colorThemes.includes(themeName?.trim()?.toLowerCase());
143:     }
144: 
145:     choiceClass(themeName) {
146:         if (!this.validateTheme(themeName)) {
147:             return { "color-choice": true };
148:         }
149:         return {
150:             "color-choice": true,
151:             [themeName]: true,
152:         };
153:     }
154: }
</file>

<file path="js/top8.js">
  1: class Top8Manager {
  2:     constructor(authManager) {
  3:         if (!authManager) {
  4:             throw new Error("[Top8Manager] AuthManager is required");
  5:         }
  6:         this.pds = new PDSRecordManager(authManager);
  7: 
  8:         // Use config values
  9:         this.recordType = CONFIG.TOP8.RECORD_TYPE;
 10:         this.recordKey = CONFIG.TOP8.RECORD_KEY;
 11: 
 12:         // Add cache for follows
 13:         this.followsCache = null;
 14:         this.lastCacheUpdate = null;
 15:         this.cacheExpiration = CONFIG.TOP8.CACHE_DURATION;
 16:     }
 17: 
 18:     async initialize() {
 19:         console.debug("[Top8Manager] Starting initialization...");
 20:         try {
 21:             const record = await this.pds.getRecord(
 22:                 this.recordType,
 23:                 this.recordKey,
 24:             );
 25:             // Add unique identifiers to each friend
 26:             const friends = record?.items || [];
 27:             return friends.map((friend, index) => ({
 28:                 ...friend,
 29:                 uniqueId: `${friend.did}-${index}`,
 30:                 position: index,
 31:             }));
 32:         } catch (error) {
 33:             console.error("[Top8Manager] Initialization error:", error);
 34:             return [];
 35:         }
 36:     }
 37: 
 38:     async loadAllFollows() {
 39:         console.debug("[Top8Manager] Loading all follows...");
 40:         const follows = [];
 41:         let cursor = null;
 42: 
 43:         try {
 44:             do {
 45:                 const url = new URL(
 46:                     `${CONFIG.API.PUBLIC_URL}/app.bsky.graph.getFollows`,
 47:                 );
 48:                 url.searchParams.append("actor", this.pds.authManager.did);
 49:                 url.searchParams.append("limit", "100");
 50:                 if (cursor) {
 51:                     url.searchParams.append("cursor", cursor);
 52:                 }
 53: 
 54:                 const response = await fetch(url);
 55:                 if (!response.ok) {
 56:                     throw new Error(`HTTP error! status: ${response.status}`);
 57:                 }
 58: 
 59:                 const data = await response.json();
 60:                 follows.push(...(data.follows || []));
 61:                 cursor = data.cursor;
 62: 
 63:                 console.debug(
 64:                     `[Top8Manager] Loaded ${follows.length} follows so far...`,
 65:                 );
 66:             } while (cursor);
 67: 
 68:             // Format follows for consistent structure
 69:             this.followsCache = follows.map((follow) => ({
 70:                 did: follow.did,
 71:                 handle: follow.handle,
 72:                 displayName: follow.displayName || follow.handle,
 73:                 avatar: follow.avatar,
 74:             }));
 75: 
 76:             this.lastCacheUpdate = Date.now();
 77:             console.debug(
 78:                 `[Top8Manager] Cached ${this.followsCache.length} total follows`,
 79:             );
 80: 
 81:             return this.followsCache;
 82:         } catch (error) {
 83:             console.error("[Top8Manager] Error loading all follows:", error);
 84:             throw error;
 85:         }
 86:     }
 87: 
 88:     isCacheValid() {
 89:         return (
 90:             this.followsCache &&
 91:             this.lastCacheUpdate &&
 92:             Date.now() - this.lastCacheUpdate < this.cacheExpiration
 93:         );
 94:     }
 95: 
 96:     async searchFollows(query) {
 97:         console.debug("[Top8Manager] Searching follows:", query);
 98: 
 99:         try {
100:             if (!this.isCacheValid()) {
101:                 await this.loadAllFollows();
102:             }
103: 
104:             const searchQuery = query.toLowerCase();
105: 
106:             // Add unique IDs to search results
107:             const results = this.followsCache
108:                 .filter(
109:                     (follow) =>
110:                         follow.handle.toLowerCase().includes(searchQuery) ||
111:                         (follow.displayName &&
112:                             follow.displayName
113:                                 .toLowerCase()
114:                                 .includes(searchQuery)),
115:                 )
116:                 .map((follow, index) => ({
117:                     ...follow,
118:                     uniqueId: `${follow.did}-${Date.now()}-${index}`,
119:                 }));
120: 
121:             console.debug(
122:                 `[Top8Manager] Found ${results.length} matches for "${query}"`,
123:             );
124:             return results;
125:         } catch (error) {
126:             console.error("[Top8Manager] Error searching follows:", error);
127:             throw error;
128:         }
129:     }
130: 
131:     async saveFriends(friends) {
132:         console.debug("[Top8Manager] Saving friends:", friends);
133: 
134:         if (
135:             !Array.isArray(friends) ||
136:             friends.length > CONFIG.TOP8.MAX_FRIENDS
137:         ) {
138:             throw new Error(
139:                 `Invalid friends list - maximum ${CONFIG.TOP8.MAX_FRIENDS} friends allowed`,
140:             );
141:         }
142: 
143:         try {
144:             const record = {
145:                 purpose: CONFIG.TOP8.LIST_PURPOSE,
146:                 name: "My Top 8 Friends",
147:                 description: "My closest friends on Bluesky",
148:                 items: friends.map((friend, index) => ({
149:                     subject: friend.did,
150:                     handle: friend.handle,
151:                     displayName: friend.displayName,
152:                     avatar: friend.avatar,
153:                     position: index,
154:                     uniqueId:
155:                         friend.uniqueId ||
156:                         `${friend.did}-${Date.now()}-${index}`,
157:                 })),
158:                 createdAt: new Date().toISOString(),
159:                 $type: this.recordType,
160:             };
161: 
162:             await this.pds.putRecord(this.recordType, this.recordKey, record);
163:             return true;
164:         } catch (error) {
165:             console.error("[Top8Manager] Error saving friends:", error);
166:             throw error;
167:         }
168:     }
169: 
170:     clearCache() {
171:         this.followsCache = null;
172:         this.lastCacheUpdate = null;
173:     }
174: }
</file>

<file path=".gitattributes">
1: # Auto detect text files and perform LF normalization
2: * text=auto
</file>

<file path=".gitignore">
 1: # Ignore everything in vendor except Alpine
 2: js/vendor/*
 3: !js/vendor/alpine.min.js
 4: !js/vendor/alpine.min.js.map
 5: 
 6: # Other common ignores
 7: node_modules/
 8: .DS_Store
 9: *.log
10: output.txt
</file>

<file path="index.html">
  1: <!doctype html>
  2: <html>
  3:     <head>
  4:         <meta charset="UTF-8" />
  5:         <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  6:         <title>Top 8 Friends</title>
  7: 
  8:         <!-- External Dependencies -->
  9:         <!-- Alpine.js must be first and defer -->
 10:         <script src="//unpkg.com/alpinejs" defer></script>
 11: 
 12:         <!-- Supporting classes -->
 13:         <script src="js/config.js"></script>
 14:         <script src="js/auth.js"></script>
 15:         <script src="js/profile.js"></script>
 16:         <script src="js/storage.js"></script>
 17:         <script src="js/posts.js"></script>
 18:         <script src="js/pds.js"></script>
 19:         <script src="js/themePDS.js"></script>
 20:         <script src="js/top8.js"></script>
 21: 
 22:         <!-- Alpine integration must be last -->
 23:         <script src="js/alpine-integration.js"></script>
 24: 
 25:         <!-- Styles -->
 26:         <link rel="stylesheet" href="css/styles.css" />
 27:     </head>
 28: 
 29:     <body x-data="theme()" :class="themeClass" class="default">
 30:         <div id="wrapper">
 31:             <!-- Logo Section -->
 32:             <div id="logo">
 33:                 <img src="/images/logo.svg" />
 34:             </div>
 35: 
 36:             <div id="wholething" x-data="appState" x-init="init">
 37:                 <!-- Left Column -->
 38:                 <div id="leftcolumn">
 39:                     <!-- Login Form -->
 40:                     <div id="addbox" class="box" x-show="!person.name">
 41:                         <h1>Log in with Bluesky</h1>
 42:                         <form @submit.prevent="loginUser">
 43:                             <div class="form-group">
 44:                                 <label for="username">Username</label>
 45:                                 <input
 46:                                     type="text"
 47:                                     id="username"
 48:                                     placeholder="username.bsky.social"
 49:                                     x-model="username"
 50:                                     required
 51:                                 />
 52:                             </div>
 53:                             <div class="form-group">
 54:                                 <label for="password">Password</label>
 55:                                 <input
 56:                                     type="password"
 57:                                     id="password"
 58:                                     placeholder="Your Bluesky password"
 59:                                     x-model="password"
 60:                                     required
 61:                                 />
 62:                             </div>
 63:                             <div
 64:                                 class="error-message"
 65:                                 x-show="loginError"
 66:                                 x-text="loginError"
 67:                             ></div>
 68:                             <button
 69:                                 type="submit"
 70:                                 :disabled="loading"
 71:                                 x-text="loading ? 'Logging in...' : 'Log in'"
 72:                             ></button>
 73:                         </form>
 74:                     </div>
 75: 
 76:                     <!-- Profile Box -->
 77:                     <div id="profilebox" class="box" x-show="person.name">
 78:                         <h1><span x-text="person.name"></span></h1>
 79:                         <p><img :src="person.avatar" :alt="person.name" /></p>
 80:                         <h2>
 81:                             <a :href="person.bsky_url" target="_blank"
 82:                                 ><span x-text="person.bsky_handle"></span
 83:                             ></a>
 84:                         </h2>
 85:                         <p x-html="person.note"></p>
 86:                         <button @click="logout">Logout</button>
 87:                     </div>
 88: 
 89:                     <!-- Theme Selector -->
 90:                     <div
 91:                         id="editbox"
 92:                         class="box"
 93:                         x-data="theme()"
 94:                         x-init="init()"
 95:                     >
 96:                         <h1>Choose Your Theme</h1>
 97:                         <div class="color-theme-container">
 98:                             <template
 99:                                 x-for="(ct, index) in colorThemes"
100:                                 :key="index"
101:                             >
102:                                 <span
103:                                     :class="choiceClass(ct)"
104:                                     @click="changeTheme(ct)"
105:                                     :title="ct"
106:                                 >
107:                                 </span>
108:                             </template>
109:                         </div>
110:                     </div>
111:                 </div>
112: 
113:                 <!-- Right Column -->
114:                 <div id="rightcolumn">
115:                     <!-- Friends List -->
116:                     <!-- Replace the entire top8box div with this corrected version -->
117:                     <div id="top8box" x-data="top8" x-init="init()">
118:                         <h1>My Top <span x-text="friends.length"></span></h1>
119: 
120:                         <!-- Add Friend Button -->
121:                         <button
122:                             @click="showDialog = true; searchQuery = ''; searchResults = []"
123:                             class="edit-button"
124:                         >
125:                             Edit Top 8
126:                         </button>
127: 
128:                         <!-- Friends Grid -->
129:                         <div class="friends-grid">
130:                             <template
131:                                 x-for="(friend, index) in friends"
132:                                 :key="friend.uniqueId || `${friend.did}-${index}`"
133:                             >
134:                                 <div class="friend">
135:                                     <img
136:                                         :src="friend.avatar || '/api/placeholder/120/120'"
137:                                         :alt="friend.displayName"
138:                                     />
139:                                     <h2 x-text="friend.displayName"></h2>
140:                                     <a
141:                                         :href="'https://bsky.app/profile/' + friend.handle"
142:                                         target="_blank"
143:                                         x-text="friend.handle"
144:                                     ></a>
145:                                 </div>
146:                             </template>
147:                         </div>
148: 
149:                         <!-- Friend Selection Dialog -->
150:                         <div
151:                             x-show="showDialog"
152:                             class="dialog-overlay"
153:                             @click="showDialog = false"
154:                         >
155:                             <div class="dialog-content box" @click.stop>
156:                                 <h2>Select Your Top 8</h2>
157: 
158:                                 <!-- Current Selection Counter -->
159:                                 <div class="selection-counter">
160:                                     Selected:
161:                                     <span x-text="selectedFriends.length"></span
162:                                     >/8
163:                                 </div>
164: 
165:                                 <!-- Search Input -->
166:                                 <div class="search-box">
167:                                     <input
168:                                         type="text"
169:                                         x-model="searchQuery"
170:                                         @input.debounce.500ms="searchFriends()"
171:                                         placeholder="Search friends..."
172:                                         :disabled="loading"
173:                                     />
174: 
175:                                     <div
176:                                         x-show="loading"
177:                                         class="loading-indicator"
178:                                     >
179:                                         <span>Loading all follows...</span>
180:                                         <div
181:                                             class="progress-note"
182:                                             x-show="followsCache"
183:                                         >
184:                                             Searching across
185:                                             <span
186:                                                 x-text="followsCache.length"
187:                                             ></span>
188:                                             follows
189:                                         </div>
190:                                     </div>
191:                                 </div>
192: 
193:                                 <!-- Error Message -->
194:                                 <div
195:                                     x-show="error"
196:                                     x-text="error"
197:                                     class="error-message"
198:                                 ></div>
199: 
200:                                 <!-- Loading Message -->
201:                                 <div x-show="loading" class="loading-message">
202:                                     <span>Searching...</span>
203:                                 </div>
204: 
205:                                 <!-- Search Results -->
206:                                 <div class="search-results" x-show="!loading">
207:                                     <template
208:                                         x-for="(friend, index) in searchResults"
209:                                         :key="friend.uniqueId || `${friend.did}-${index}`"
210:                                     >
211:                                         <div
212:                                             class="friend-item"
213:                                             :class="{ 'selected': isFriendSelected(friend) }"
214:                                             @click="toggleFriend(friend)"
215:                                         >
216:                                             <img
217:                                                 :src="friend.avatar || '/api/placeholder/40/40'"
218:                                                 :alt="friend.displayName"
219:                                                 class="avatar"
220:                                             />
221:                                             <div class="friend-info">
222:                                                 <span
223:                                                     class="name"
224:                                                     x-text="friend.displayName"
225:                                                 ></span>
226:                                                 <span
227:                                                     class="handle"
228:                                                     x-text="'@' + friend.handle"
229:                                                 ></span>
230:                                             </div>
231:                                             <div
232:                                                 class="select-indicator"
233:                                                 x-show="isFriendSelected(friend)"
234:                                             >
235:                                                 ✓
236:                                             </div>
237:                                         </div>
238:                                     </template>
239: 
240:                                     <div
241:                                         x-show="searchQuery && !loading && !searchResults.length"
242:                                         class="no-results"
243:                                     >
244:                                         No friends found matching your search
245:                                     </div>
246:                                 </div>
247: 
248:                                 <!-- Dialog Buttons -->
249:                                 <div class="dialog-buttons">
250:                                     <button
251:                                         @click="showDialog = false"
252:                                         class="cancel-button"
253:                                     >
254:                                         Cancel
255:                                     </button>
256:                                     <button
257:                                         @click="saveFriends()"
258:                                         :disabled="loading"
259:                                         class="save-button"
260:                                     >
261:                                         Save Changes
262:                                     </button>
263:                                 </div>
264:                             </div>
265:                         </div>
266:                     </div>
267: 
268:                     <!-- Posts Section -->
269:                     <!-- Replace the existing Posts Section in index.html with this: -->
270:                     <template x-if="person.bsky_handle">
271:                         <div id="postbox" x-data="posts">
272:                             <h1>My Latest Posts</h1>
273: 
274:                             <!-- Loading State -->
275:                             <div x-show="loading" class="loading">
276:                                 Loading posts...
277:                             </div>
278: 
279:                             <!-- Error State -->
280:                             <div
281:                                 x-show="error"
282:                                 class="error"
283:                                 x-text="error"
284:                             ></div>
285: 
286:                             <!-- Posts -->
287:                             <template x-for="blog in blogs" :key="blog.uri">
288:                                 <div class="post">
289:                                     <p x-html="blog.text"></p>
290:                                     <div class="post-meta">
291:                                         <a
292:                                             :href="blog.author.url"
293:                                             target="_blank"
294:                                         >
295:                                             <span
296:                                                 x-text="blog.author.name"
297:                                             ></span>
298:                                             (@<span
299:                                                 x-text="blog.author.handle"
300:                                             ></span
301:                                             >)
302:                                         </a>
303:                                         <span
304:                                             x-text="new Date(blog.createdAt).toLocaleString()"
305:                                         ></span>
306:                                     </div>
307:                                 </div>
308:                             </template>
309: 
310:                             <!-- No Posts State -->
311:                             <div
312:                                 x-show="!loading && !error && blogs.length === 0"
313:                                 class="no-posts"
314:                             >
315:                                 No posts found
316:                             </div>
317:                         </div>
318:                     </template>
319:                 </div>
320:             </div>
321:         </div>
322:     </body>
323: </html>
</file>

<file path="README.md">
1: # top8_test
2:  
3: let's ruthlessly rank our friends again.
</file>

</repository_files>